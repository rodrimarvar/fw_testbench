<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>QP/C: State Dynamics Viewpoint</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="doxygen-awesome-darkmode-toggle.js"></script>
<script type="text/javascript" src="doxygen-awesome-fragment-copy-button.js"></script>
<script type="text/javascript" src="doxygen-awesome-paragraph-link.js"></script>
<script type="text/javascript">
    DoxygenAwesomeFragmentCopyButton.init()
    DoxygenAwesomeDarkModeToggle.init()
    DoxygenAwesomeParagraphLink.init()
</script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only-darkmode-toggle.css" rel="stylesheet" type="text/css"/>
<link href="spexy-awesome.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
  <div id="projectlogo">
    <a href="https://www.state-machine.com" title="Quantum Leaps"><img alt="Logo" src="logo_ql.webp"/></a>
  </div>
   <div id="projectname">
    QP/C
    &nbsp;<span id="projectnumber">8.0.2</span>
   </div>
   <div id="projectbrief">Real-Time Embedded Framework</div>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.13.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;"
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('sds-qp_state.html',''); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">State Dynamics Viewpoint</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><span class="prev_button"><a class="el" href="sds-qp_inter.html">Interaction Viewpoint</a></span><span class="next_button"><a class="el" href="sds-qp_time.html">Time Viewpoint</a></span> </p><div style="clear:both"></div> <p>The <b>State Dynamics Viewpoint</b> explains how QP Application shall implement hierarchical state machines. This design viewpoint is most important and relevant to <b>QP Application developers</b>, who's primary activity is designing and ultimately implementing the hierarchical state machines of Active Objects.</p>
<p>This viewpoint consists of two parts:</p><ul>
<li><a class="el" href="#sds-qp_state-hsm">state machine implementation strategy based on the QHsm class</a> (designed for "manual coding", see <a class="el" href="srs-qp_sm.html#SRS_QP_SM_20">SRS_QP_SM_20</a>)</li>
<li><a class="el" href="#sds-qp_state-hsm">state machine implementation strategy based on the QMsm class</a> (designed for "automatic code generation", see <a class="el" href="srs-qp_sm.html#SRS_QP_SM_21">SRS_QP_SM_21</a>)</li>
</ul>
<p>The design concerns in this viewpoint correspond to the "recipes" for implementing various state machine elements. The state diagram and the table below list the elements and provides links to the design views in the "QHsm-based implementation" and "QMsm-based implementation".</p>
<p><a class="anchor" id="sds-qp_fig-sm"></a></p><div class="image">
<img src="sds-qp_sm.png" alt="" width="1500px"/>
</div>
  <div class="caption"><center><em>Figure SDS-SM: Example Hierarchical State Machine (a toaster oven)</em></center></div><p> The state machine elements labeled in <a class="el" href="#sds-qp_fig-sm">Figure SDS-SM</a> are as follows: </p><table class="doxtable">
<tr>
<th>Label </th><th>Design concern </th><th>QHsm-based<br  />
implementation </th><th>QMsm-based<br  />
implementation </th></tr>
<tr>
<td></td><td>declaring application-level state machine subclass </td><td><a class="el" href="#SDS_QA_QHsm_decl">SDS_QA_QHsm_decl</a> </td><td><a class="el" href="#SDS_QA_QMsm_decl">SDS_QA_QMsm_decl</a> </td></tr>
<tr>
<td><code>[1]</code> </td><td>implementing top-most initial pseudo-state </td><td><a class="el" href="#SDS_QA_QHsm_top_init">SDS_QA_QHsm_top_init</a> </td><td><a class="el" href="#SDS_QA_QMsm_top_init">SDS_QA_QMsm_top_init</a> </td></tr>
<tr>
<td><code>[2]</code> </td><td>implementing states (including states nested in other states) </td><td><a class="el" href="#SDS_QA_QHsm_state">SDS_QA_QHsm_state</a> </td><td><a class="el" href="#SDS_QA_QMsm_state">SDS_QA_QMsm_state</a> </td></tr>
<tr>
<td><code>[3]</code> </td><td>implementing state entry actions </td><td><a class="el" href="#SDS_QA_QHsm_entry">SDS_QA_QHsm_entry</a> </td><td><a class="el" href="#SDS_QA_QMsm_entry">SDS_QA_QMsm_entry</a> </td></tr>
<tr>
<td><code>[4]</code> </td><td>implementing state exit actions </td><td><a class="el" href="#SDS_QA_QHsm_exit">SDS_QA_QHsm_exit</a> </td><td><a class="el" href="#SDS_QA_QMsm_exit">SDS_QA_QMsm_exit</a> </td></tr>
<tr>
<td><code>[5]</code> </td><td>implementing nested initial transitions </td><td><a class="el" href="#SDS_QA_QHsm_nest_init">SDS_QA_QHsm_nest_init</a> </td><td><a class="el" href="#SDS_QA_QMsm_nest_init">SDS_QA_QMsm_nest_init</a> </td></tr>
<tr>
<td><code>[6]</code> </td><td>implementing state transitions </td><td><a class="el" href="#SDS_QA_QHsm_tran">SDS_QA_QHsm_tran</a> </td><td><a class="el" href="#SDS_QA_QMsm_tran">SDS_QA_QMsm_tran</a> </td></tr>
<tr>
<td><code>[7]</code> </td><td>implementing internal transitions </td><td><a class="el" href="#SDS_QA_QHsm_intern">SDS_QA_QHsm_intern</a> </td><td><a class="el" href="#SDS_QA_QMsm_intern">SDS_QA_QMsm_intern</a> </td></tr>
<tr>
<td><code>[8]</code> </td><td>implementing choice points and guard conditions </td><td><a class="el" href="#SDS_QA_QHsm_choice">SDS_QA_QHsm_choice</a> </td><td><a class="el" href="#SDS_QA_QMsm_choice">SDS_QA_QMsm_choice</a> </td></tr>
<tr>
<td><code>[9]</code> </td><td>Guard condition with internal transition </td><td><a class="el" href="#SDS_QA_QHsm_choice">SDS_QA_QHsm_choice</a> </td><td><a class="el" href="#SDS_QA_QMsm_choice">SDS_QA_QMsm_choice</a> </td></tr>
<tr>
<td><code>[10]</code> </td><td>Guard condition with regular transition </td><td><a class="el" href="#SDS_QA_QHsm_choice">SDS_QA_QHsm_choice</a> </td><td><a class="el" href="#SDS_QA_QMsm_choice">SDS_QA_QMsm_choice</a> </td></tr>
<tr>
<td><code>[11]</code> </td><td>implementing state history </td><td><a class="el" href="#SDS_QA_QHsm_hist">SDS_QA_QHsm_hist</a> </td><td><a class="el" href="#SDS_QA_QMsm_hist">SDS_QA_QMsm_hist</a> </td></tr>
<tr>
<td><code>[12]</code> </td><td>implementing transition to state history </td><td><a class="el" href="#SDS_QA_QHsm_hist_tran">SDS_QA_QHsm_hist_tran</a> </td><td><a class="el" href="#SDS_QA_QMsm_hist_tran">SDS_QA_QMsm_hist_tran</a> </td></tr>
</table>
<dl class="section note"><dt>Note</dt><dd>The design concerns included in this State Dynamics viewpoint apply to <b>QP Applications</b> rather than QP Framework and therefore they are use the UIDs <code>SDS_QA_...</code> (with the component part set to <code>QA</code> rather than <code>QP</code>).</dd></dl>
<p>The <b>model kind</b> used to illustrate the State Dynamics Viewpoint is the UML <em>state diagram</em> shown in <a class="el" href="#sds-qp_fig-sm">Figure SDS-SM</a> and <a class="el" href="#sds-qp_fig-sm">Figure SDS-SM</a> (static views). These state diagrams depict hierarchical state machines (for a toaster oven) with labeled elements, which are subsequently elaborated in various traceable Design Views.</p>
<h1><a class="anchor" id="sds-qp_state-hsm"></a>
QHsm Design View</h1>
<p>This section presents the <a class="el" href="srs-qp_sm.html#srs-qp_sm-impl">hierarchical state machine implementation strategy</a> "optimized for manual coding", which means that changing a single element in the state machine design (e.g., nesting of the state hierarchy) should require changing only a single matching element in the implementation. This strategy imposes restrictions on the implementation, but does not mean that the code must be written manually. In the presence of a modeling tool, such code can also be generated automatically and most of the code presented in this section has indeed been generated by the <a href="https://www.state-machine.com/products/qm" target="_blank" rel="noopener">QM modeling tool&uarr;</a> (from the state diagram presented in <a class="el" href="#sds-qp_fig-sm">Figure SDS-SM</a>).</p>
<p><a id="a139_SDS_5FQA_5FQHsm_5Fdecl" name="a139_SDS_5FQA_5FQHsm_5Fdecl"></a> </p>
<h2><a class="anchor" id="SDS_QA_QHsm_decl"></a>
SDS_QA_QHsm_decl</h2>
<table class="doxtable">
<tr>
<td style="text-align:left; width:var(--content-maxwidth)"><p class="starttd"><b>SDS_QA_QHsm_decl</b>: <em>Declaring <a class="el" href="struct_q_hsm.html" title="Hierarchical State Machine class (QHsm-style state machine implementation strategy)">QHsm</a> subclass.</em></p>
<p class="endtd"></p>
</td></tr>
<tr>
<td><p class="starttd"><b>Description</b><br  />
</p>
<p class="endtd">The first step in coding a hierarchical state machine based on the <a class="el" href="struct_q_hsm.html" title="Hierarchical State Machine class (QHsm-style state machine implementation strategy)">QHsm</a> implementation is to declare a subclass of the <a class="el" href="struct_q_hsm.html" title="Hierarchical State Machine class (QHsm-style state machine implementation strategy)">QHsm</a> or the <a class="el" href="struct_q_active.html" title="Active object class (based on the QHsm implementation strategy)">QActive</a> base class. </p>
</td></tr>
<tr>
<td><p class="starttd"><b>Example</b><br  />
</p>
<p class="intertd">The following snippet of code shows the complete declaration of the <code>ToasterOven</code> subclass of <a class="el" href="struct_q_hsm.html" title="Hierarchical State Machine class (QHsm-style state machine implementation strategy)">QHsm</a> shown in <a class="el" href="#sds-qp_fig-sm">Figure SDS-SM</a>:  </p><div class="fragment"><div class="line">[1]  <span class="keyword">typedef</span> <span class="keyword">struct </span>{</div>
<div class="line">     <span class="comment">// protected:</span></div>
<div class="line">[2]      <a class="code hl_class" href="struct_q_hsm.html">QHsm</a> super;</div>
<div class="line"> </div>
<div class="line">     <span class="comment">// private:</span></div>
<div class="line">[3]      uint32_t settings;</div>
<div class="line">         uint16_t temp;</div>
<div class="line">         <a class="code hl_class" href="struct_q_time_evt.html">QTimeEvt</a> te;</div>
<div class="line"> </div>
<div class="line">     <span class="comment">// private state histories</span></div>
<div class="line">[4]      <a class="code hl_typedef" href="qp_8h.html#a797a6e3e20119fcb0911cffb94e49543">QStateHandler</a> hist_doorClosed;</div>
<div class="line">[1]  } ToasterOven;</div>
<div class="line"> </div>
<div class="line">     <span class="comment">// public:</span></div>
<div class="line">[10] <span class="keywordtype">void</span> ToasterOven_ctor(ToasterOven * <span class="keyword">const</span> me) {</div>
<div class="line">[11]     QHsm_ctor(&amp;me-&gt;super, <a class="code hl_define" href="qp_8h.html#a6531b0ab582f41275f19d28ac91d9e4f">Q_STATE_CAST</a>(&amp;ToasterOven_initial));</div>
<div class="line">[12]     QTimeEvt_ctorX(&amp;me-&gt;te, &amp;me-&gt;super, TIMEOUT_SIG, 0U),</div>
<div class="line">     }</div>
<div class="line"> </div>
<div class="line">     <span class="comment">// protected:</span></div>
<div class="line">[20] <a class="code hl_typedef" href="qp_8h.html#ad141f4e9efcba4613f82a8b2c76663ad">QState</a> ToasterOven_initial(ToasterOven * <span class="keyword">const</span> me, <span class="keywordtype">void</span> <span class="keyword">const</span> * <span class="keyword">const</span> par);</div>
<div class="line"> </div>
<div class="line">[30] <a class="code hl_typedef" href="qp_8h.html#ad141f4e9efcba4613f82a8b2c76663ad">QState</a> ToasterOven_doorClosed(ToasterOven * <span class="keyword">const</span> me, <a class="code hl_class" href="struct_q_evt.html">QEvt</a> <span class="keyword">const</span> * <span class="keyword">const</span> e);</div>
<div class="line">     <a class="code hl_typedef" href="qp_8h.html#ad141f4e9efcba4613f82a8b2c76663ad">QState</a> ToasterOven_heating(ToasterOven * <span class="keyword">const</span> me, <a class="code hl_class" href="struct_q_evt.html">QEvt</a> <span class="keyword">const</span> * <span class="keyword">const</span> e);</div>
<div class="line">     <a class="code hl_typedef" href="qp_8h.html#ad141f4e9efcba4613f82a8b2c76663ad">QState</a> ToasterOven_toasting(ToasterOven * <span class="keyword">const</span> me, <a class="code hl_class" href="struct_q_evt.html">QEvt</a> <span class="keyword">const</span> * <span class="keyword">const</span> e);</div>
<div class="line">     <a class="code hl_typedef" href="qp_8h.html#ad141f4e9efcba4613f82a8b2c76663ad">QState</a> ToasterOven_baking(ToasterOven * <span class="keyword">const</span> me, <a class="code hl_class" href="struct_q_evt.html">QEvt</a> <span class="keyword">const</span> * <span class="keyword">const</span> e);</div>
<div class="line">     <a class="code hl_typedef" href="qp_8h.html#ad141f4e9efcba4613f82a8b2c76663ad">QState</a> ToasterOven_off(ToasterOven * <span class="keyword">const</span> me, <a class="code hl_class" href="struct_q_evt.html">QEvt</a> <span class="keyword">const</span> * <span class="keyword">const</span> e);</div>
<div class="line">     <a class="code hl_typedef" href="qp_8h.html#ad141f4e9efcba4613f82a8b2c76663ad">QState</a> ToasterOven_doorOpen(ToasterOven * <span class="keyword">const</span> me, <a class="code hl_class" href="struct_q_evt.html">QEvt</a> <span class="keyword">const</span> * <span class="keyword">const</span> e);</div>
<div class="line"> </div>
<div class="line">     <span class="comment">// private:</span></div>
<div class="line">[40] <span class="keywordtype">void</span> ToasterOven_actionA(ToasterOven * <span class="keyword">const</span> me);</div>
<div class="line">     <span class="keywordtype">void</span> ToasterOven_actionB(ToasterOven * <span class="keyword">const</span> me);</div>
<div class="ttc" id="aqp_8h_html_a6531b0ab582f41275f19d28ac91d9e4f"><div class="ttname"><a href="qp_8h.html#a6531b0ab582f41275f19d28ac91d9e4f">Q_STATE_CAST</a></div><div class="ttdeci">#define Q_STATE_CAST(handler_)</div><div class="ttdoc">Perform cast to QStateHandler.</div><div class="ttdef"><b>Definition</b> <a href="qp_8h_source.html#l00175">qp.h:175</a></div></div>
<div class="ttc" id="aqp_8h_html_a797a6e3e20119fcb0911cffb94e49543"><div class="ttname"><a href="qp_8h.html#a797a6e3e20119fcb0911cffb94e49543">QStateHandler</a></div><div class="ttdeci">QState(* QStateHandler)(void *const me, QEvt const *const e)</div><div class="ttdoc">Pointer to a state-handler function.</div><div class="ttdef"><b>Definition</b> <a href="qp_8h_source.html#l00148">qp.h:148</a></div></div>
<div class="ttc" id="aqp_8h_html_ad141f4e9efcba4613f82a8b2c76663ad"><div class="ttname"><a href="qp_8h.html#ad141f4e9efcba4613f82a8b2c76663ad">QState</a></div><div class="ttdeci">uint_fast8_t QState</div><div class="ttdoc">Type returned from state-handler functions.</div><div class="ttdef"><b>Definition</b> <a href="qp_8h_source.html#l00147">qp.h:147</a></div></div>
<div class="ttc" id="astruct_q_evt_html"><div class="ttname"><a href="struct_q_evt.html">QEvt</a></div><div class="ttdoc">Event class.</div><div class="ttdef"><b>Definition</b> <a href="qp_8h_source.html#l00115">qp.h:115</a></div></div>
<div class="ttc" id="astruct_q_hsm_html"><div class="ttname"><a href="struct_q_hsm.html">QHsm</a></div><div class="ttdoc">Hierarchical State Machine class (QHsm-style state machine implementation strategy)</div><div class="ttdef"><b>Definition</b> <a href="qp_8h_source.html#l00254">qp.h:254</a></div></div>
<div class="ttc" id="astruct_q_time_evt_html"><div class="ttname"><a href="struct_q_time_evt.html">QTimeEvt</a></div><div class="ttdoc">Time Event class.</div><div class="ttdef"><b>Definition</b> <a href="qp_8h_source.html#l00629">qp.h:629</a></div></div>
</div><!-- fragment --><p> <code>[1]</code> Declaration of class <code>ToasterOven</code></p>
<p class="intertd"><code>[2]</code> Class <code>ToasterOven</code> inherits <a class="el" href="struct_q_hsm.html" title="Hierarchical State Machine class (QHsm-style state machine implementation strategy)">QHsm</a>, so it can have a state machine that must be implemented according to the rules specified in the <a class="el" href="#sds-qp_state-hsm">QHsm Design View</a>. </p><dl class="section note"><dt>Note</dt><dd>The state machine implementation is identical, whether it inherits <a class="el" href="struct_q_hsm.html" title="Hierarchical State Machine class (QHsm-style state machine implementation strategy)">QHsm</a>, <a class="el" href="struct_q_active.html" title="Active object class (based on the QHsm implementation strategy)">QActive</a>, or subclasses of these base classes.</dd></dl>
<p><code>[3]</code> The class can have data members (typically private), which will be accessible inside the state machine as the "extended-state variables".</p>
<p class="intertd"><code>[4]</code> If the state machine uses state history (<a class="el" href="#sds-qp_fig-sm">Figure SDS-SM [11]</a>), a data member must be provided to remember each state's history.</p>
<p class="intertd"><a class="anchor" id="qpc-hsm_ctor"></a><code>[10]</code> The class needs to provide a <em>constructor</em>, typically without any parameters. </p><dl class="section note"><dt>Note</dt><dd>The role of the constructor is just to initialize the state machine instance to bind it to the top-most initial pseudo-state (see step <code>[5]</code>). Most other data members are initialized in the top-most initial transition, which is taken later, when when the state machine is initialized (see <a class="el" href="#SDS_QA_QHsm_top_init">SDS_QA_QHsm_top_init</a>).</dd></dl>
<p><code>[11]</code> The class <em>constructor</em>, must call the superclass' constructor (<a class="el" href="struct_q_hsm.html#ac7ee65ede9bc841b7b1c4564e13b084d">QHsm_ctor()</a> constructor in this case). The superclass' constructor initializes this state machine to the top-most initial pseudostate declared in step <code>[5]</code>.</p>
<p class="intertd"><code>[12]</code> The class <em>constructor</em>, must call the constructors of its data members, if such constructors exist.</p>
<p class="intertd"><code>[20]</code> Each state machine must have exactly one initial pseudo-state, which is a member function of the class as shown in the listing. By convention, the initial pseudo-state should be always called <code>initial</code>.</p>
<p class="endtd"><code>[30]</code> All states are represented as member functions of the sate machine class (hence they are called <em>state-handler functions</em>). Every state-handler function takes the const pointer to the current event as a parameter. </p><dl class="section note"><dt>Note</dt><dd>All states are declared the same way regardless of their nesting level.</dd></dl>
<p><code>[40]</code> The class might also provide any number of action functions that will be called in the state machine.  </p>
</td></tr>
<tr>
<td><p class="starttd"><b>Backward Traceability</b><br  />
</p>
<ul>
<li><a class="el" href="sas-qp_ctxt.html#SAS_QP_FRM">SAS_QP_FRM</a>: <em>QP Framework layer</em> </li>
</ul>
</td></tr>
<tr>
<td><p class="starttd"><b>Forward Traceability (truncated to 2 level(s))</b><br  />
</p>
<p class="endtd"></p>
</td></tr>
</table>
<p><a id="a140_SDS_5FQA_5FQHsm_5Ftop_5Finit" name="a140_SDS_5FQA_5FQHsm_5Ftop_5Finit"></a> </p>
<h2><a class="anchor" id="SDS_QA_QHsm_top_init"></a>
SDS_QA_QHsm_top_init</h2>
<table class="doxtable">
<tr>
<td style="text-align:left; width:var(--content-maxwidth)"><p class="starttd"><b>SDS_QA_QHsm_top_init</b>: <em>Implementing the top-most initial pseudo-state.</em></p>
<p class="endtd"></p>
</td></tr>
<tr>
<td><p class="starttd"><b>Description</b><br  />
</p>
<p class="endtd">The top-most initial pseudostate is a member function of the sate machine class (see <a class="el" href="#sds-qp_fig-sm">Figure SDS-SM [1]</a>). This pseudostate defines the top-most initial transition, which will be taken when the state machine is initialized (see <a class="el" href="sds-qp_struct.html#SDS_QP_QAsm">SDS_QP_QAsm</a> interface <code>init()</code> function). </p>
</td></tr>
<tr>
<td><p class="starttd"><b>Example</b><br  />
</p>
<p class="intertd">The following example code shows a top-most initial pseudo-state function with various elements explained in the labeled annotations following the listing.  </p><div class="fragment"><div class="line">[1]  <a class="code hl_typedef" href="qp_8h.html#ad141f4e9efcba4613f82a8b2c76663ad">QState</a> ToasterOven_initial(ToasterOven * <span class="keyword">const</span> me, <span class="keywordtype">void</span> <span class="keyword">const</span> * <span class="keyword">const</span> par) {</div>
<div class="line">[2]      me-&gt;setting = DEFAULT_SETTINGS;</div>
<div class="line">         me-&gt;temp = BSP_temp();</div>
<div class="line">         <span class="comment">// state history attributes</span></div>
<div class="line">[3]      me-&gt;hist_doorClosed = <a class="code hl_define" href="qp_8h.html#a6531b0ab582f41275f19d28ac91d9e4f">Q_STATE_CAST</a>(&amp;ToasterOven_off);</div>
<div class="line"> </div>
<div class="line">[4]      <a class="code hl_define" href="qs__dummy_8h.html#a3b1ab21c174f2bec448edec8865a8529">QS_FUN_DICTIONARY</a>(&amp;ToasterOven_doorClosed);</div>
<div class="line">         <a class="code hl_define" href="qs__dummy_8h.html#a3b1ab21c174f2bec448edec8865a8529">QS_FUN_DICTIONARY</a>(&amp;ToasterOven_heating);</div>
<div class="line">         <a class="code hl_define" href="qs__dummy_8h.html#a3b1ab21c174f2bec448edec8865a8529">QS_FUN_DICTIONARY</a>(&amp;ToasterOven_toasting);</div>
<div class="line">         <a class="code hl_define" href="qs__dummy_8h.html#a3b1ab21c174f2bec448edec8865a8529">QS_FUN_DICTIONARY</a>(&amp;ToasterOven_baking);</div>
<div class="line">         <a class="code hl_define" href="qs__dummy_8h.html#a3b1ab21c174f2bec448edec8865a8529">QS_FUN_DICTIONARY</a>(&amp;ToasterOven_off);</div>
<div class="line">         <a class="code hl_define" href="qs__dummy_8h.html#a3b1ab21c174f2bec448edec8865a8529">QS_FUN_DICTIONARY</a>(&amp;ToasterOven_doorOpen);</div>
<div class="line"> </div>
<div class="line">[5]      <span class="keywordflow">return</span> <a class="code hl_define" href="qp_8h.html#a8f06cd90ba5060780fc61a4810e3eb50">Q_TRAN</a>(&amp;ToasterOven_doorClosed);</div>
<div class="line">     }</div>
<div class="ttc" id="aqp_8h_html_a8f06cd90ba5060780fc61a4810e3eb50"><div class="ttname"><a href="qp_8h.html#a8f06cd90ba5060780fc61a4810e3eb50">Q_TRAN</a></div><div class="ttdeci">#define Q_TRAN(target_)</div><div class="ttdoc">Take transition to the specified target_ state.</div><div class="ttdef"><b>Definition</b> <a href="qp_8h_source.html#l00299">qp.h:299</a></div></div>
<div class="ttc" id="aqs__dummy_8h_html_a3b1ab21c174f2bec448edec8865a8529"><div class="ttname"><a href="qs__dummy_8h.html#a3b1ab21c174f2bec448edec8865a8529">QS_FUN_DICTIONARY</a></div><div class="ttdeci">#define QS_FUN_DICTIONARY(fun_)</div><div class="ttdef"><b>Definition</b> <a href="qs__dummy_8h_source.html#l00072">qs_dummy.h:72</a></div></div>
</div><!-- fragment --><p> <code>[1]</code> The top-most initial pseudostate function signature (see also <a class="el" href="#SDS_QA_QHsm_decl">SDS_QA_QHsm_decl</a> <code>[5]</code>)</p>
<p class="intertd"><code>[2]</code> The top-most initial pseudostate initializes internal variables (see also <a class="el" href="#SDS_QA_QHsm_decl">SDS_QA_QHsm_decl</a> <code>[3]</code>)</p>
<p class="intertd"><code>[3]</code> The top-most initial pseudostate initializes state histories for all states with history (see also <a class="el" href="#SDS_QA_QHsm_hist">SDS_QA_QHsm_hist</a>)</p>
<p class="intertd"><code>[4]</code> If <a class="el" href="class_q_s.html" title="Software tracing instrumentation, target-resident component (QS namespace emulated as a &quot;class&quot; in C)">QS</a> software tracing is used, the top-most initial pseudostate produces function dictionaries for all its state-handler functions</p>
<p class="endtd"><code>[5]</code> The top-most initial pseudostate must return with the <a class="el" href="qp_8h.html#a8f06cd90ba5060780fc61a4810e3eb50" title="Take transition to the specified target_ state.">Q_TRAN()</a> macro. The argument of this macro is the target state indicated in the diagram (see <a class="el" href="#sds-qp_fig-sm">Figure SDS-SM [1]</a>)  </p>
</td></tr>
<tr>
<td><p class="starttd"><b>Backward Traceability</b><br  />
</p>
<ul>
<li><a class="el" href="sas-qp_ctxt.html#SAS_QP_FRM">SAS_QP_FRM</a>: <em>QP Framework layer</em> </li>
</ul>
</td></tr>
<tr>
<td><p class="starttd"><b>Forward Traceability (truncated to 2 level(s))</b><br  />
</p>
<p class="endtd"></p>
</td></tr>
</table>
<p><a id="a141_SDS_5FQA_5FQHsm_5Fstate" name="a141_SDS_5FQA_5FQHsm_5Fstate"></a> </p>
<h2><a class="anchor" id="SDS_QA_QHsm_state"></a>
SDS_QA_QHsm_state</h2>
<table class="doxtable">
<tr>
<td style="text-align:left; width:var(--content-maxwidth)"><p class="starttd"><b>SDS_QA_QHsm_state</b>: <em>Implementing a state and its nesting.</em></p>
<p class="endtd"></p>
</td></tr>
<tr>
<td><p class="starttd"><b>Description</b><br  />
</p>
<p class="endtd">States are member functions of the sate machine class (see <a class="el" href="#sds-qp_fig-sm">Figure SDS-SM [2]</a>). State-handler functions are called during the process of <a class="el" href="srs-qp_sm.html#srs-qp_sm-dispatch">dispatching events</a>. Their purpose is to perform <em>your</em> specific actions and then to <em>tell</em> the <a class="el" href="srs-qp_sm.html#srs-qp_sm-proc">%QP event processor</a> what your state-handler has just done. For example, if your state-handler performs a state transition, it executes some actions and then it calls the special <a class="el" href="qp_8h.html#a8f06cd90ba5060780fc61a4810e3eb50" title="Take transition to the specified target_ state.">Q_TRAN()</a> macro, where it specifies the target state of this state transition. The state-handler then <b>returns</b> the status from the <a class="el" href="qp_8h.html#a8f06cd90ba5060780fc61a4810e3eb50" title="Take transition to the specified target_ state.">Q_TRAN()</a> macro, and through this return value it informs the <a class="el" href="srs-qp_sm.html#srs-qp_sm-dispatch">dispatch operation</a> what needs to be done with the state machine. Based on this information, the event-processor might decide to call this or other state-handler functions to process the same current event. </p>
</td></tr>
<tr>
<td><p class="starttd"><b>Example</b><br  />
</p>
<p class="intertd">The following example code shows two state-handler functions with almost identical structure. The first one implements a top-level state. The second one implements a state that is explicitly nested in another state. </p><dl class="section note"><dt>Note</dt><dd>The general structure of state-handler functions is the same regardless of their nesting level.</dd></dl>
<div class="fragment"><div class="line">    <span class="comment">// top-level state</span></div>
<div class="line">[1] <a class="code hl_typedef" href="qp_8h.html#ad141f4e9efcba4613f82a8b2c76663ad">QState</a> ToasterOven_doorClosed(ToasterOven * <span class="keyword">const</span> me, <a class="code hl_class" href="struct_q_evt.html">QEvt</a> <span class="keyword">const</span> * <span class="keyword">const</span> e) {</div>
<div class="line">[2]     <a class="code hl_typedef" href="qp_8h.html#ad141f4e9efcba4613f82a8b2c76663ad">QState</a> status_;</div>
<div class="line">[3]     <span class="keywordflow">switch</span> (e-&gt;<a class="code hl_variable" href="struct_q_evt.html#a20b1ceebb91aea39fcbc633aeae6cd3f">sig</a>) {</div>
<div class="line">[4]         . . .</div>
<div class="line">[5]         <span class="keywordflow">default</span>: {</div>
<div class="line">[6a]            status_ = <a class="code hl_define" href="qp_8h.html#ad8abd2f7098c41ec464343d9d8f1eadc">Q_SUPER</a>(&amp;QHsm_top);</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line">[7]     <span class="keywordflow">return</span> status_;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// state explicitly nested in another state</span></div>
<div class="line">[1] <a class="code hl_typedef" href="qp_8h.html#ad141f4e9efcba4613f82a8b2c76663ad">QState</a> ToasterOven_heating(ToasterOven * <span class="keyword">const</span> me, <a class="code hl_class" href="struct_q_evt.html">QEvt</a> <span class="keyword">const</span> * <span class="keyword">const</span> e) {</div>
<div class="line">[2]     <a class="code hl_typedef" href="qp_8h.html#ad141f4e9efcba4613f82a8b2c76663ad">QState</a> status_;</div>
<div class="line">[3]     <span class="keywordflow">switch</span> (e-&gt;<a class="code hl_variable" href="struct_q_evt.html#a20b1ceebb91aea39fcbc633aeae6cd3f">sig</a>) {</div>
<div class="line">[4]         . . .</div>
<div class="line">[5]         <span class="keywordflow">default</span>: {</div>
<div class="line">[6b]            status_ = <a class="code hl_define" href="qp_8h.html#ad8abd2f7098c41ec464343d9d8f1eadc">Q_SUPER</a>(&amp;ToasterOven_doorClosed);</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line">[7]     <span class="keywordflow">return</span> status_;</div>
<div class="line">    }</div>
<div class="ttc" id="aqp_8h_html_ad8abd2f7098c41ec464343d9d8f1eadc"><div class="ttname"><a href="qp_8h.html#ad8abd2f7098c41ec464343d9d8f1eadc">Q_SUPER</a></div><div class="ttdeci">#define Q_SUPER(super_)</div><div class="ttdoc">Designates the superstate of a given state. Applicable only to QHsm subclasses.</div><div class="ttdef"><b>Definition</b> <a href="qp_8h_source.html#l00305">qp.h:305</a></div></div>
<div class="ttc" id="astruct_q_evt_html_a20b1ceebb91aea39fcbc633aeae6cd3f"><div class="ttname"><a href="struct_q_evt.html#a20b1ceebb91aea39fcbc633aeae6cd3f">QEvt::sig</a></div><div class="ttdeci">QSignal sig</div><div class="ttdoc">Signal of the event (see Event Signal)</div><div class="ttdef"><b>Definition</b> <a href="qp_8h_source.html#l00116">qp.h:116</a></div></div>
</div><!-- fragment --><p> <code>[1]</code> The state function signature (see also <a class="el" href="#SDS_QA_QHsm_decl">SDS_QA_QHsm_decl</a> <code>[6]</code>). The function takes the <code>me</code> pointer (OOP) and a <code>const</code> pointer to the current event <code>e</code>.</p>
<p class="intertd"><code>[2]</code> The local <code>status_</code> variable to return at the end of the state-handler function</p>
<p class="intertd"><code>[3]</code> The state-handler function is structured as a <code>switch</code> statement that discriminates based on the signal of the current event <code>e-&gt;sig</code> (see <a class="el" href="sds-qp_struct.html#SDS_QP_QEvt">SDS_QP_QEvt</a>)</p>
<p class="intertd"><code>[4]</code> the case of the switch implement various state elements explained in the remaining Design Elements in this viewpoint.</p>
<p class="intertd"><code>[5]</code> The <code>switch</code> must always have the default case, which should be executed <b>without side effects</b>.</p>
<p class="intertd"><code>[6a]</code> For a state that does not nest in any other state, you need to set the <code>status_</code> variable to the <a class="el" href="qp_8h.html#a8f06cd90ba5060780fc61a4810e3eb50" title="Take transition to the specified target_ state.">Q_TRAN()</a> macro, whereas the argument <a class="el" href="struct_q_hsm.html#a291b48e585af5e2c2baa3113746c98e0">QHsm_top()</a> is the top-most state handler function defined in the <a class="el" href="struct_q_hsm.html" title="Hierarchical State Machine class (QHsm-style state machine implementation strategy)">QHsm</a> base class.</p>
<p class="endtd"><code>[6b]</code> For a state that explicitly nests in another state, you need to set the <code>status_</code> variable to the <a class="el" href="qp_8h.html#a8f06cd90ba5060780fc61a4810e3eb50" title="Take transition to the specified target_ state.">Q_TRAN()</a> macro, whereas the argument is the superstate of that state.  </p>
</td></tr>
<tr>
<td><p class="starttd"><b>Backward Traceability</b><br  />
</p>
<ul>
<li><a class="el" href="sas-qp_ctxt.html#SAS_QP_FRM">SAS_QP_FRM</a>: <em>QP Framework layer</em> </li>
</ul>
</td></tr>
<tr>
<td><p class="starttd"><b>Forward Traceability (truncated to 2 level(s))</b><br  />
</p>
<p class="endtd"></p>
</td></tr>
</table>
<p><a id="a142_SDS_5FQA_5FQHsm_5Fentry" name="a142_SDS_5FQA_5FQHsm_5Fentry"></a> </p>
<h2><a class="anchor" id="SDS_QA_QHsm_entry"></a>
SDS_QA_QHsm_entry</h2>
<table class="doxtable">
<tr>
<td style="text-align:left; width:var(--content-maxwidth)"><p class="starttd"><b>SDS_QA_QHsm_entry</b>: <em>Implementing state entry action.</em></p>
<p class="endtd"></p>
</td></tr>
<tr>
<td><p class="starttd"><b>Description</b><br  />
</p>
<p class="endtd">State entry action (see <a class="el" href="#sds-qp_fig-sm">Figure SDS-SM [3]</a>) is coded as special case for the reserved signal <a class="el" href="qp_8h.html#aa6dc9adf3f51310aa41685019829374b" title="reserved signal sent to state handler to execute the entry case)">Q_ENTRY_SIG</a>. The QP event processor executes the entry action during a state transition processing by calling the state-handler function passing in the reserved event with the <a class="el" href="qp_8h.html#aa6dc9adf3f51310aa41685019829374b" title="reserved signal sent to state handler to execute the entry case)">Q_ENTRY_SIG</a>. Please note that the entry action has no access to the original event that triggered the state transition. </p>
</td></tr>
<tr>
<td><p class="starttd"><b>Example</b><br  />
</p>
<p class="intertd">The following example code shows a state-handler function with an entry action.  </p><div class="fragment"><div class="line">    <a class="code hl_typedef" href="qp_8h.html#ad141f4e9efcba4613f82a8b2c76663ad">QState</a> ToasterOven_heating(ToasterOven * <span class="keyword">const</span> me, <a class="code hl_class" href="struct_q_evt.html">QEvt</a> <span class="keyword">const</span> * <span class="keyword">const</span> e) {</div>
<div class="line">        <a class="code hl_typedef" href="qp_8h.html#ad141f4e9efcba4613f82a8b2c76663ad">QState</a> status_;</div>
<div class="line">        <span class="keywordflow">switch</span> (e-&gt;<a class="code hl_variable" href="struct_q_evt.html#a20b1ceebb91aea39fcbc633aeae6cd3f">sig</a>) {</div>
<div class="line">[1]         <span class="keywordflow">case</span> <a class="code hl_define" href="qp_8h.html#aa6dc9adf3f51310aa41685019829374b">Q_ENTRY_SIG</a>: {</div>
<div class="line">[2]             QTimeEvt_armX(&amp;me-&gt;te, 100, 0U);</div>
<div class="line">[3]             status_ = <a class="code hl_define" href="qp_8h.html#a54b2da5e70ef983cfa7ca74deac237a3">Q_HANDLED</a>();</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line">            }</div>
<div class="line">            . . .</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">return</span> status_;</div>
<div class="line">    }</div>
<div class="ttc" id="aqp_8h_html_a54b2da5e70ef983cfa7ca74deac237a3"><div class="ttname"><a href="qp_8h.html#a54b2da5e70ef983cfa7ca74deac237a3">Q_HANDLED</a></div><div class="ttdeci">#define Q_HANDLED()</div><div class="ttdoc">Indicate that an action has been &quot;handled&quot;. Applies to entry/exit actions and to internal transitions...</div><div class="ttdef"><b>Definition</b> <a href="qp_8h_source.html#l00308">qp.h:308</a></div></div>
<div class="ttc" id="aqp_8h_html_aa6dc9adf3f51310aa41685019829374b"><div class="ttname"><a href="qp_8h.html#aa6dc9adf3f51310aa41685019829374b">Q_ENTRY_SIG</a></div><div class="ttdeci">#define Q_ENTRY_SIG</div><div class="ttdoc">reserved signal sent to state handler to execute the entry case)</div><div class="ttdef"><b>Definition</b> <a href="qp_8h_source.html#l00212">qp.h:212</a></div></div>
</div><!-- fragment --><p> <code>[1]</code> State with an entry action needs a case-statement on the reserved signal <a class="el" href="qp_8h.html#aa6dc9adf3f51310aa41685019829374b" title="reserved signal sent to state handler to execute the entry case)">Q_ENTRY_SIG</a> </p><dl class="section note"><dt>Note</dt><dd>The <code>case Q_ENTRY_SIG</code> is needed only if a state actually has something to do upon the state entry. If there is nothing to do, the whole case can be just omitted.</dd></dl>
<p><code>[2]</code> Inside the case, you code all the actions to be called upon the entry to the state.</p>
<p class="endtd"><code>[3]</code> The action list must end with setting the status to the <a class="el" href="qp_8h.html#a54b2da5e70ef983cfa7ca74deac237a3" title="Indicate that an action has been &quot;handled&quot;. Applies to entry/exit actions and to internal transitions...">Q_HANDLED()</a> macro, which informs the QP event processor that the entry action has been handled.  </p>
</td></tr>
<tr>
<td><p class="starttd"><b>Backward Traceability</b><br  />
</p>
<ul>
<li><a class="el" href="sas-qp_ctxt.html#SAS_QP_FRM">SAS_QP_FRM</a>: <em>QP Framework layer</em> </li>
</ul>
</td></tr>
<tr>
<td><p class="starttd"><b>Forward Traceability (truncated to 2 level(s))</b><br  />
</p>
<p class="endtd"></p>
</td></tr>
</table>
<p><a id="a143_SDS_5FQA_5FQHsm_5Fexit" name="a143_SDS_5FQA_5FQHsm_5Fexit"></a> </p>
<h2><a class="anchor" id="SDS_QA_QHsm_exit"></a>
SDS_QA_QHsm_exit</h2>
<table class="doxtable">
<tr>
<td style="text-align:left; width:var(--content-maxwidth)"><p class="starttd"><b>SDS_QA_QHsm_exit</b>: <em>Implementing state exit action.</em></p>
<p class="endtd"></p>
</td></tr>
<tr>
<td><p class="starttd"><b>Description</b><br  />
</p>
<p class="endtd">State exit action (see <a class="el" href="#sds-qp_fig-sm">Figure SDS-SM [4]</a>) is coded as special <code>case</code> on the reserved signal <a class="el" href="qp_8h.html#a6cf79ec599f6d7870aafe06c71de79be" title="reserved signal sent to state handler to execute the exit case)">Q_EXIT_SIG</a>. The QP event processor executes the exit action during a state transition processing by calling the state-handler function passing in the reserved event with the <a class="el" href="qp_8h.html#a6cf79ec599f6d7870aafe06c71de79be" title="reserved signal sent to state handler to execute the exit case)">Q_EXIT_SIG</a>. Please note that the entry action has no access to the original event that triggered the state transition. </p>
</td></tr>
<tr>
<td><p class="starttd"><b>Example</b><br  />
</p>
<p class="intertd">The following example code shows a state-handler function with an exit action.  </p><div class="fragment"><div class="line">    <a class="code hl_typedef" href="qp_8h.html#ad141f4e9efcba4613f82a8b2c76663ad">QState</a> ToasterOven_heating(ToasterOven * <span class="keyword">const</span> me, <a class="code hl_class" href="struct_q_evt.html">QEvt</a> <span class="keyword">const</span> * <span class="keyword">const</span> e) {</div>
<div class="line">        <a class="code hl_typedef" href="qp_8h.html#ad141f4e9efcba4613f82a8b2c76663ad">QState</a> status_;</div>
<div class="line">        <span class="keywordflow">switch</span> (e-&gt;<a class="code hl_variable" href="struct_q_evt.html#a20b1ceebb91aea39fcbc633aeae6cd3f">sig</a>) {</div>
<div class="line">            . . .</div>
<div class="line">[1]         <span class="keywordflow">case</span> <a class="code hl_define" href="qp_8h.html#a6cf79ec599f6d7870aafe06c71de79be">Q_EXIT_SIG</a>: {</div>
<div class="line">[2]             (void)QTimeEvt_disarm(&amp;me-&gt;te);</div>
<div class="line">[3]             status_ = <a class="code hl_define" href="qp_8h.html#a54b2da5e70ef983cfa7ca74deac237a3">Q_HANDLED</a>();</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line">            }</div>
<div class="line">            . . .</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">return</span> status_;</div>
<div class="line">    }</div>
<div class="ttc" id="aqp_8h_html_a6cf79ec599f6d7870aafe06c71de79be"><div class="ttname"><a href="qp_8h.html#a6cf79ec599f6d7870aafe06c71de79be">Q_EXIT_SIG</a></div><div class="ttdeci">#define Q_EXIT_SIG</div><div class="ttdoc">reserved signal sent to state handler to execute the exit case)</div><div class="ttdef"><b>Definition</b> <a href="qp_8h_source.html#l00213">qp.h:213</a></div></div>
</div><!-- fragment --><p> <code>[1]</code> State with an exit action needs a <code>case</code> statement on the reserved signal <a class="el" href="qp_8h.html#a6cf79ec599f6d7870aafe06c71de79be" title="reserved signal sent to state handler to execute the exit case)">Q_EXIT_SIG</a> </p><dl class="section note"><dt>Note</dt><dd>The <code>case Q_EXIT_SIG</code> is needed only if a state actually has something to do upon the state exit. If there is nothing to do, the whole case can be just omitted.</dd></dl>
<p><code>[2]</code> Inside the case, you code all the actions to be called upon the exit from the state.</p>
<p class="endtd"><code>[3]</code> The action list must end with setting the status to the <a class="el" href="qp_8h.html#a54b2da5e70ef983cfa7ca74deac237a3" title="Indicate that an action has been &quot;handled&quot;. Applies to entry/exit actions and to internal transitions...">Q_HANDLED()</a> macro, which informs the QP event processor that the exit action has been handled.  </p>
</td></tr>
<tr>
<td><p class="starttd"><b>Backward Traceability</b><br  />
</p>
<ul>
<li><a class="el" href="sas-qp_ctxt.html#SAS_QP_FRM">SAS_QP_FRM</a>: <em>QP Framework layer</em> </li>
</ul>
</td></tr>
<tr>
<td><p class="starttd"><b>Forward Traceability (truncated to 2 level(s))</b><br  />
</p>
<p class="endtd"></p>
</td></tr>
</table>
<p><a id="a144_SDS_5FQA_5FQHsm_5Fnest_5Finit" name="a144_SDS_5FQA_5FQHsm_5Fnest_5Finit"></a> </p>
<h2><a class="anchor" id="SDS_QA_QHsm_nest_init"></a>
SDS_QA_QHsm_nest_init</h2>
<table class="doxtable">
<tr>
<td style="text-align:left; width:var(--content-maxwidth)"><p class="starttd"><b>SDS_QA_QHsm_nest_init</b>: <em>Implementing nested initial transition.</em></p>
<p class="endtd"></p>
</td></tr>
<tr>
<td><p class="starttd"><b>Description</b><br  />
</p>
<p class="endtd">Nested initial transition (see <a class="el" href="#sds-qp_fig-sm">Figure SDS-SM [5]</a>) in a state is coded as special case for the reserved signal <a class="el" href="qp_8h.html#ab1a3d74abc659d49b63453c981aace18" title="reserved signal sent to state handler to execute the initial transition)">Q_INIT_SIG</a>. If a state has no nested initial transition, the whole case can be just omitted. </p>
</td></tr>
<tr>
<td><p class="starttd"><b>Example</b><br  />
</p>
<p class="intertd">The following example code shows a state-handler function with nested initial transition.  </p><div class="fragment"><div class="line">    <a class="code hl_typedef" href="qp_8h.html#ad141f4e9efcba4613f82a8b2c76663ad">QState</a> ToasterOven_heating(ToasterOven * <span class="keyword">const</span> me, <a class="code hl_class" href="struct_q_evt.html">QEvt</a> <span class="keyword">const</span> * <span class="keyword">const</span> e) {</div>
<div class="line">        <a class="code hl_typedef" href="qp_8h.html#ad141f4e9efcba4613f82a8b2c76663ad">QState</a> status_;</div>
<div class="line">        <span class="keywordflow">switch</span> (e-&gt;<a class="code hl_variable" href="struct_q_evt.html#a20b1ceebb91aea39fcbc633aeae6cd3f">sig</a>) {</div>
<div class="line">            . . .</div>
<div class="line">[1]         <span class="keywordflow">case</span> <a class="code hl_define" href="qp_8h.html#ab1a3d74abc659d49b63453c981aace18">Q_INIT_SIG</a>: {</div>
<div class="line">[2]             me-&gt;temp = BSP_temp(); <span class="comment">// get temperature</span></div>
<div class="line">[3]             status_ = <a class="code hl_define" href="qp_8h.html#a8f06cd90ba5060780fc61a4810e3eb50">Q_TRAN</a>(&amp;ToasterOven_baking);</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line">            }</div>
<div class="line">            . . .</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">return</span> status_;</div>
<div class="line">    }</div>
<div class="ttc" id="aqp_8h_html_ab1a3d74abc659d49b63453c981aace18"><div class="ttname"><a href="qp_8h.html#ab1a3d74abc659d49b63453c981aace18">Q_INIT_SIG</a></div><div class="ttdeci">#define Q_INIT_SIG</div><div class="ttdoc">reserved signal sent to state handler to execute the initial transition)</div><div class="ttdef"><b>Definition</b> <a href="qp_8h_source.html#l00214">qp.h:214</a></div></div>
</div><!-- fragment --><p> <code>[1]</code> State with a nested initial transition needs a case-statement on the reserved signal <a class="el" href="qp_8h.html#ab1a3d74abc659d49b63453c981aace18" title="reserved signal sent to state handler to execute the initial transition)">Q_INIT_SIG</a></p>
<p class="intertd"><code>[2]</code> Inside the case, you code all the actions to be called upon the initial transition.</p>
<p class="endtd"><code>[3]</code> The action list must end with setting the status to the <a class="el" href="qp_8h.html#a8f06cd90ba5060780fc61a4810e3eb50" title="Take transition to the specified target_ state.">Q_TRAN()</a> macro with the argument being the substate-handler, which informs the QP event processor about the next state and that the nested initial transition has been executed. </p><dl class="section attention"><dt>Attention</dt><dd>The target of the nested initial transition specified with the macro <a class="el" href="qp_8h.html#a8f06cd90ba5060780fc61a4810e3eb50" title="Take transition to the specified target_ state.">Q_TRAN()</a> must be a substate of the given state.  </dd></dl>
</td></tr>
<tr>
<td><p class="starttd"><b>Backward Traceability</b><br  />
</p>
<ul>
<li><a class="el" href="sas-qp_ctxt.html#SAS_QP_FRM">SAS_QP_FRM</a>: <em>QP Framework layer</em> </li>
</ul>
</td></tr>
<tr>
<td><p class="starttd"><b>Forward Traceability (truncated to 2 level(s))</b><br  />
</p>
<p class="endtd"></p>
</td></tr>
</table>
<p><a id="a145_SDS_5FQA_5FQHsm_5Ftran" name="a145_SDS_5FQA_5FQHsm_5Ftran"></a> </p>
<h2><a class="anchor" id="SDS_QA_QHsm_tran"></a>
SDS_QA_QHsm_tran</h2>
<table class="doxtable">
<tr>
<td style="text-align:left; width:var(--content-maxwidth)"><p class="starttd"><b>SDS_QA_QHsm_tran</b>: <em>Implementing state transition.</em></p>
<p class="endtd"></p>
</td></tr>
<tr>
<td><p class="starttd"><b>Description</b><br  />
</p>
<p class="endtd">A state transition (see <a class="el" href="#sds-qp_fig-sm">Figure SDS-SM [6]</a>) is coded as special case for the user-defined signal (transition trigger). </p>
</td></tr>
<tr>
<td><p class="starttd"><b>Example</b><br  />
</p>
<p class="intertd">The following example code shows a state-handler function with a state transition.  </p><div class="fragment"><div class="line">    <a class="code hl_typedef" href="qp_8h.html#ad141f4e9efcba4613f82a8b2c76663ad">QState</a> ToasterOven_doorClosed(ToasterOven * <span class="keyword">const</span> me, <a class="code hl_class" href="struct_q_evt.html">QEvt</a> <span class="keyword">const</span> * <span class="keyword">const</span> e) {</div>
<div class="line">        <a class="code hl_typedef" href="qp_8h.html#ad141f4e9efcba4613f82a8b2c76663ad">QState</a> status_;</div>
<div class="line">        <span class="keywordflow">switch</span> (e-&gt;<a class="code hl_variable" href="struct_q_evt.html#a20b1ceebb91aea39fcbc633aeae6cd3f">sig</a>) {</div>
<div class="line">            . . .</div>
<div class="line">[1]         <span class="keywordflow">case</span> OPEN_SIG: {</div>
<div class="line">[2]             ToasterOven_actionA(me);</div>
<div class="line">[3]             status_ = <a class="code hl_define" href="qp_8h.html#a8f06cd90ba5060780fc61a4810e3eb50">Q_TRAN</a>(&amp;ToasterOven_doorOpen);</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line">            }</div>
<div class="line">            . . .</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">return</span> status_;</div>
<div class="line">    }</div>
</div><!-- fragment --><p> <code>[1]</code> State with a transition needs a case-statement on the user-defined signal (transition trigger).</p>
<p class="intertd"><code>[2]</code> Inside the case, you code all the actions to be called upon the transition.</p>
<p class="endtd"><code>[3]</code> The action list must end with setting the status to the <a class="el" href="qp_8h.html#a8f06cd90ba5060780fc61a4810e3eb50" title="Take transition to the specified target_ state.">Q_TRAN()</a> macro. The argument of this macro is the target state indicated in the diagram (see <a class="el" href="#sds-qp_fig-sm">Figure SDS-SM [6]</a>)  </p>
</td></tr>
<tr>
<td><p class="starttd"><b>Backward Traceability</b><br  />
</p>
<ul>
<li><a class="el" href="sas-qp_ctxt.html#SAS_QP_FRM">SAS_QP_FRM</a>: <em>QP Framework layer</em> </li>
</ul>
</td></tr>
<tr>
<td><p class="starttd"><b>Forward Traceability (truncated to 2 level(s))</b><br  />
</p>
<p class="endtd"></p>
</td></tr>
</table>
<p><a id="a146_SDS_5FQA_5FQHsm_5Fintern" name="a146_SDS_5FQA_5FQHsm_5Fintern"></a> </p>
<h2><a class="anchor" id="SDS_QA_QHsm_intern"></a>
SDS_QA_QHsm_intern</h2>
<table class="doxtable">
<tr>
<td style="text-align:left; width:var(--content-maxwidth)"><p class="starttd"><b>SDS_QA_QHsm_intern</b>: <em>Implementing internal transition.</em></p>
<p class="endtd"></p>
</td></tr>
<tr>
<td><p class="starttd"><b>Description</b><br  />
</p>
<p class="endtd">An internal transition (see <a class="el" href="#sds-qp_fig-sm">Figure SDS-SM [7]</a>) is coded as special case for the user-defined signal (transition trigger). </p>
</td></tr>
<tr>
<td><p class="starttd"><b>Example</b><br  />
</p>
<p class="intertd">The following example code shows a state-handler function with an internal transition.  </p><div class="fragment"><div class="line">    <a class="code hl_typedef" href="qp_8h.html#ad141f4e9efcba4613f82a8b2c76663ad">QState</a> ToasterOven_off(ToasterOven * <span class="keyword">const</span> me, <a class="code hl_class" href="struct_q_evt.html">QEvt</a> <span class="keyword">const</span> * <span class="keyword">const</span> e) {</div>
<div class="line">        <a class="code hl_typedef" href="qp_8h.html#ad141f4e9efcba4613f82a8b2c76663ad">QState</a> status_;</div>
<div class="line">        <span class="keywordflow">switch</span> (e-&gt;<a class="code hl_variable" href="struct_q_evt.html#a20b1ceebb91aea39fcbc633aeae6cd3f">sig</a>) {</div>
<div class="line">            . . .</div>
<div class="line">[1]         <span class="keywordflow">case</span> SETUP_SIG: {</div>
<div class="line">[2]             me-&gt;setup = <a class="code hl_define" href="qp_8h.html#a9f117cb1bc50e9ef4dcc933533ccdd7f">Q_EVT_CAST</a>(SetupEvt)-&gt;setup;</div>
<div class="line">[3]             status_ = <a class="code hl_define" href="qp_8h.html#a54b2da5e70ef983cfa7ca74deac237a3">Q_HANDLED</a>();</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line">            }</div>
<div class="line">            . . .</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">return</span> status_;</div>
<div class="line">    }</div>
<div class="ttc" id="aqp_8h_html_a9f117cb1bc50e9ef4dcc933533ccdd7f"><div class="ttname"><a href="qp_8h.html#a9f117cb1bc50e9ef4dcc933533ccdd7f">Q_EVT_CAST</a></div><div class="ttdeci">#define Q_EVT_CAST(class_)</div><div class="ttdoc">Perform downcast of an event onto a subclass of QEvt class_</div><div class="ttdef"><b>Definition</b> <a href="qp_8h_source.html#l00142">qp.h:142</a></div></div>
</div><!-- fragment --><p> <code>[1]</code> State with a transition needs a case-statement on the user-defined signal (transition trigger).</p>
<p class="intertd"><code>[2]</code> Inside the case, you code all the actions to be called upon the transition.</p>
<p class="endtd"><code>[3]</code> The action list must end with setting the status to the <a class="el" href="qp_8h.html#a54b2da5e70ef983cfa7ca74deac237a3" title="Indicate that an action has been &quot;handled&quot;. Applies to entry/exit actions and to internal transitions...">Q_HANDLED()</a> macro, which informs the QP event processor that the <em>internal</em> transition has been handled.  </p>
</td></tr>
<tr>
<td><p class="starttd"><b>Backward Traceability</b><br  />
</p>
<ul>
<li><a class="el" href="sas-qp_ctxt.html#SAS_QP_FRM">SAS_QP_FRM</a>: <em>QP Framework layer</em> </li>
</ul>
</td></tr>
<tr>
<td><p class="starttd"><b>Forward Traceability (truncated to 2 level(s))</b><br  />
</p>
<p class="endtd"></p>
</td></tr>
</table>
<p><a id="a147_SDS_5FQA_5FQHsm_5Fchoice" name="a147_SDS_5FQA_5FQHsm_5Fchoice"></a> </p>
<h2><a class="anchor" id="SDS_QA_QHsm_choice"></a>
SDS_QA_QHsm_choice</h2>
<table class="doxtable">
<tr>
<td style="text-align:left; width:var(--content-maxwidth)"><p class="starttd"><b>SDS_QA_QHsm_choice</b>: <em>Implementing choice point and guard conditions.</em></p>
<p class="endtd"></p>
</td></tr>
<tr>
<td><p class="starttd"><b>Description</b><br  />
</p>
<p class="endtd">A choice point with guard conditions (see <a class="el" href="#sds-qp_fig-sm">Figure SDS-SM [8]</a>) is coded as special case for the user-defined signal (transition trigger). </p>
</td></tr>
<tr>
<td><p class="starttd"><b>Example</b><br  />
</p>
<p class="intertd">The following example code shows a state-handler function with an internal transition.  </p><div class="fragment"><div class="line">    <a class="code hl_typedef" href="qp_8h.html#ad141f4e9efcba4613f82a8b2c76663ad">QState</a> ToasterOven_heating(ToasterOven * <span class="keyword">const</span> me, <a class="code hl_class" href="struct_q_evt.html">QEvt</a> <span class="keyword">const</span> * <span class="keyword">const</span> e) {</div>
<div class="line">        <a class="code hl_typedef" href="qp_8h.html#ad141f4e9efcba4613f82a8b2c76663ad">QState</a> status_;</div>
<div class="line">        <span class="keywordflow">switch</span> (e-&gt;<a class="code hl_variable" href="struct_q_evt.html#a20b1ceebb91aea39fcbc633aeae6cd3f">sig</a>) {</div>
<div class="line">            . . .</div>
<div class="line">[1]         <span class="keywordflow">case</span> TIMEOUT_SIG: {</div>
<div class="line">[2]             me-&gt;temp = BSP_temp();</div>
<div class="line">[3]             <span class="keywordflow">if</span> (me-&gt;temp &gt;= LIMIT) {</div>
<div class="line">[4]                 <span class="comment">// any actions</span></div>
<div class="line">[5]                 status_ = <a class="code hl_define" href="qp_8h.html#a8f06cd90ba5060780fc61a4810e3eb50">Q_TRAN</a>(&amp;ToasterOven_off);</div>
<div class="line">                }</div>
<div class="line">[6]             <span class="keywordflow">else</span> {</div>
<div class="line">[7]                 <span class="comment">// any actions</span></div>
<div class="line">[8]                 status_ = <a class="code hl_define" href="qp_8h.html#a54b2da5e70ef983cfa7ca74deac237a3">Q_HANDLED</a>();</div>
<div class="line">                }</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line">            }</div>
<div class="line">            . . .</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">return</span> status_;</div>
<div class="line">    }</div>
</div><!-- fragment --><p> <code>[1]</code> State with a choice needs a case-statement for the user-defined signal (transition trigger).</p>
<p class="intertd"><code>[2]</code> Inside the case, you code all the actions to be called before any guard conditions are evaluated.</p>
<p class="intertd"><code>[3]</code> The guard condition is represented as a condition of the <code>if</code> statement.</p>
<p class="intertd"><code>[4]</code> any actions to be executed if the guard evaluates to 'true'.</p>
<p class="intertd"><code>[5]</code> regular state transition is coded as usual with the <a class="el" href="qp_8h.html#a8f06cd90ba5060780fc61a4810e3eb50" title="Take transition to the specified target_ state.">Q_TRAN()</a> macro with the target of the transition specified as the argument.</p>
<p class="intertd"><code>[6]</code> the complementary guard condition to all evaluated before is specified with the <code>else</code> statement. </p><dl class="section note"><dt>Note</dt><dd>A choice point might have many outgoing guards, each specified in <code>else if (guard)</code></dd></dl>
<p><code>[7]</code> any actions to be executed for this guard condition.</p>
<p class="endtd"><code>[8]</code> The action list must end with setting the status to the <a class="el" href="qp_8h.html#a54b2da5e70ef983cfa7ca74deac237a3" title="Indicate that an action has been &quot;handled&quot;. Applies to entry/exit actions and to internal transitions...">Q_HANDLED()</a> macro, which informs the QP event processor that the <em>internal</em> transition has been handled..  </p>
</td></tr>
<tr>
<td><p class="starttd"><b>Backward Traceability</b><br  />
</p>
<ul>
<li><a class="el" href="sas-qp_ctxt.html#SAS_QP_FRM">SAS_QP_FRM</a>: <em>QP Framework layer</em> </li>
</ul>
</td></tr>
<tr>
<td><p class="starttd"><b>Forward Traceability (truncated to 2 level(s))</b><br  />
</p>
<p class="endtd"></p>
</td></tr>
</table>
<p><a id="a148_SDS_5FQA_5FQHsm_5Fhist" name="a148_SDS_5FQA_5FQHsm_5Fhist"></a> </p>
<h2><a class="anchor" id="SDS_QA_QHsm_hist"></a>
SDS_QA_QHsm_hist</h2>
<table class="doxtable">
<tr>
<td style="text-align:left; width:var(--content-maxwidth)"><p class="starttd"><b>SDS_QA_QHsm_hist</b>: <em>Implementing state history.</em></p>
<p class="endtd"></p>
</td></tr>
<tr>
<td><p class="starttd"><b>Description</b><br  />
</p>
<p class="endtd">State history (see <a class="el" href="#sds-qp_fig-sm">Figure SDS-SM [11]</a>) requires remembering the most recent active substate when the given state is exited, which is accomplished in the exit action from the state coded as already described in <a class="el" href="#SDS_QA_QHsm_exit">SDS_QA_QHsm_exit</a>. </p>
</td></tr>
<tr>
<td><p class="starttd"><b>Example</b><br  />
</p>
<p class="intertd">The following example code shows an exit action that additionally saves the state history.  </p><div class="fragment"><div class="line">    <a class="code hl_typedef" href="qp_8h.html#ad141f4e9efcba4613f82a8b2c76663ad">QState</a> ToasterOven_doorClosed(ToasterOven * <span class="keyword">const</span> me, <a class="code hl_class" href="struct_q_evt.html">QEvt</a> <span class="keyword">const</span> * <span class="keyword">const</span> e) {</div>
<div class="line">        <a class="code hl_typedef" href="qp_8h.html#ad141f4e9efcba4613f82a8b2c76663ad">QState</a> status_;</div>
<div class="line">        <span class="keywordflow">switch</span> (e-&gt;<a class="code hl_variable" href="struct_q_evt.html#a20b1ceebb91aea39fcbc633aeae6cd3f">sig</a>) {</div>
<div class="line">            . . .</div>
<div class="line">[1]         <span class="keywordflow">case</span> <a class="code hl_define" href="qp_8h.html#a6cf79ec599f6d7870aafe06c71de79be">Q_EXIT_SIG</a>: {</div>
<div class="line">[2]             <span class="comment">// any exit actions</span></div>
<div class="line">                <span class="comment">// save deep history</span></div>
<div class="line">[3]             me-&gt;hist_doorClosed = QHsm_state(<a class="code hl_define" href="qp_8h.html#a64c8ea5d2c6a79e4c215d07bdeb2f1b3">Q_HSM_UPCAST</a>(me));</div>
<div class="line">[4]             status_ = <a class="code hl_define" href="qp_8h.html#a54b2da5e70ef983cfa7ca74deac237a3">Q_HANDLED</a>();</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line">            }</div>
<div class="line">            . . .</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">return</span> status_;</div>
<div class="line">    }</div>
<div class="ttc" id="aqp_8h_html_a64c8ea5d2c6a79e4c215d07bdeb2f1b3"><div class="ttname"><a href="qp_8h.html#a64c8ea5d2c6a79e4c215d07bdeb2f1b3">Q_HSM_UPCAST</a></div><div class="ttdeci">#define Q_HSM_UPCAST(ptr_)</div><div class="ttdoc">Perform upcasting from a subclass of QHsm to the base class QHsm.</div><div class="ttdef"><b>Definition</b> <a href="qp_8h_source.html#l00297">qp.h:297</a></div></div>
</div><!-- fragment --><p> <code>[1]</code> State with an exit action needs a case-statement on the reserved signal <a class="el" href="qp_8h.html#a6cf79ec599f6d7870aafe06c71de79be" title="reserved signal sent to state handler to execute the exit case)">Q_EXIT_SIG</a></p>
<p class="intertd"><code>[2]</code> Inside the case, you code all the actions to be called upon the exit from the state.</p>
<p class="intertd"><code>[3]</code> One of the actions must be to set the history variable for the given state to the currently active state. The <a class="el" href="struct_q_hsm.html" title="Hierarchical State Machine class (QHsm-style state machine implementation strategy)">QHsm</a> base class provides two member functions to obtain the current state:</p><ul>
<li><a class="el" href="struct_q_hsm.html#a8b743166d44f6df43568c256b85a6ef4">QHsm_state()</a> to obtain the currently active state for <b>deep history</b></li>
<li><a class="el" href="struct_q_hsm.html#af03f75d32aa015fb73ed0802813b8fba">QHsm_childState()</a> to obtain the immediate active child state of the given state for <b>shallow history</b></li>
</ul>
<p class="endtd"><code>[4]</code> The action list must end with setting the status to the <a class="el" href="qp_8h.html#a54b2da5e70ef983cfa7ca74deac237a3" title="Indicate that an action has been &quot;handled&quot;. Applies to entry/exit actions and to internal transitions...">Q_HANDLED()</a> macro, which informs the QP event processor that the exit action has been executed.  </p>
</td></tr>
<tr>
<td><p class="starttd"><b>Backward Traceability</b><br  />
</p>
<ul>
<li><a class="el" href="sas-qp_ctxt.html#SAS_QP_FRM">SAS_QP_FRM</a>: <em>QP Framework layer</em> </li>
</ul>
</td></tr>
<tr>
<td><p class="starttd"><b>Forward Traceability (truncated to 2 level(s))</b><br  />
</p>
<p class="endtd"></p>
</td></tr>
</table>
<p><a id="a149_SDS_5FQA_5FQHsm_5Fhist_5Ftran" name="a149_SDS_5FQA_5FQHsm_5Fhist_5Ftran"></a> </p>
<h2><a class="anchor" id="SDS_QA_QHsm_hist_tran"></a>
SDS_QA_QHsm_hist_tran</h2>
<table class="doxtable">
<tr>
<td style="text-align:left; width:var(--content-maxwidth)"><p class="starttd"><b>SDS_QA_QHsm_hist_tran</b>: <em>Implementing transition to history.</em></p>
<p class="endtd"></p>
</td></tr>
<tr>
<td><p class="starttd"><b>Description</b><br  />
</p>
<p class="endtd">Transition to state history (see <a class="el" href="#sds-qp_fig-sm">Figure SDS-SM [12]</a>) is coded similar as a regular state transition, but takes the transition with the </p>
</td></tr>
<tr>
<td><p class="starttd"><b>Example</b><br  />
</p>
<p class="intertd">The following example code shows a transition to state history.  </p><div class="fragment"><div class="line">    <a class="code hl_typedef" href="qp_8h.html#ad141f4e9efcba4613f82a8b2c76663ad">QState</a> ToasterOven_doorOpen(ToasterOven * <span class="keyword">const</span> me, <a class="code hl_class" href="struct_q_evt.html">QEvt</a> <span class="keyword">const</span> * <span class="keyword">const</span> e) {</div>
<div class="line">        <a class="code hl_typedef" href="qp_8h.html#ad141f4e9efcba4613f82a8b2c76663ad">QState</a> status_;</div>
<div class="line">        <span class="keywordflow">switch</span> (e-&gt;<a class="code hl_variable" href="struct_q_evt.html#a20b1ceebb91aea39fcbc633aeae6cd3f">sig</a>) {</div>
<div class="line">            . . .</div>
<div class="line">[1]         <span class="keywordflow">case</span> CLOSE_SIG: {</div>
<div class="line">[2]             <span class="comment">// any actions</span></div>
<div class="line">[3]             status_ = <a class="code hl_define" href="qp_8h.html#ac927f38462ffb9c8cca4e4f2920f8fcd">Q_TRAN_HIST</a>(me-&gt;hist_doorClosed);</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line">            }</div>
<div class="line">            . . .</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">return</span> status_;</div>
<div class="line">    }</div>
<div class="ttc" id="aqp_8h_html_ac927f38462ffb9c8cca4e4f2920f8fcd"><div class="ttname"><a href="qp_8h.html#ac927f38462ffb9c8cca4e4f2920f8fcd">Q_TRAN_HIST</a></div><div class="ttdeci">#define Q_TRAN_HIST(hist_)</div><div class="ttdoc">Take transition to the specified history of a given state. Applicable only to HSMs.</div><div class="ttdef"><b>Definition</b> <a href="qp_8h_source.html#l00302">qp.h:302</a></div></div>
</div><!-- fragment --><p> <code>[1]</code> State with a transition to history needs a case-statement for the user-defined signal (transition trigger).</p>
<p class="intertd"><code>[2]</code> Inside the case, you code all the actions to be called upon the transition.</p>
<p class="endtd"><code>[3]</code> The action list must end with setting the status to the <a class="el" href="qp_8h.html#ac927f38462ffb9c8cca4e4f2920f8fcd" title="Take transition to the specified history of a given state. Applicable only to HSMs.">Q_TRAN_HIST()</a> macro with the state history variable of the transition specified as the argument.  </p>
</td></tr>
<tr>
<td><p class="starttd"><b>Backward Traceability</b><br  />
</p>
<ul>
<li><a class="el" href="sas-qp_ctxt.html#SAS_QP_FRM">SAS_QP_FRM</a>: <em>QP Framework layer</em> </li>
</ul>
</td></tr>
<tr>
<td><p class="starttd"><b>Forward Traceability (truncated to 2 level(s))</b><br  />
</p>
<p class="endtd"></p>
</td></tr>
</table>
<h1><a class="anchor" id="sds-qp_state-msm"></a>
QMsm Design View</h1>
<p>This section presents the <a class="el" href="srs-qp_sm.html#srs-qp_sm-impl">hierarchical state machine implementation strategy</a> "optimized for automatic code generation" (see <a class="el" href="srs-qp_sm.html#SRS_QP_SM_21">SRS_QP_SM_21</a>), which means the implementation may contain some redundant information to improve the <em>speed</em> of the state machine execution at the expense of larger code and data (typically in ROM).</p>
<p>This strategy requires a code generator, such as the <a href="https://www.state-machine.com/products/qm" target="_blank" rel="noopener">QM modeling tool&uarr;</a>. Indeed, the presented code in the Design Views below has been automatically generated by QM (from the state diagram presented in <a class="el" href="#sds-qp_fig-sm">Figure SDS-SM</a>).</p>
<dl class="section note"><dt>Note</dt><dd>The purpose of this section is to describe the design of the generated code for the purpose of its <em>readability</em> and the ability to <em>debug</em> such code, but not to implement it manually.</dd></dl>
<p><a id="a150_SDS_5FQA_5FQMsm_5Fdecl" name="a150_SDS_5FQA_5FQMsm_5Fdecl"></a> </p>
<h2><a class="anchor" id="SDS_QA_QMsm_decl"></a>
SDS_QA_QMsm_decl</h2>
<table class="doxtable">
<tr>
<td style="text-align:left; width:var(--content-maxwidth)"><p class="starttd"><b>SDS_QA_QMsm_decl</b>: <em>Declaring <a class="el" href="struct_q_msm.html" title="Hierarchical State Machine class (QMsm-style state machine implementation strategy)">QMsm</a> subclass.</em></p>
<p class="endtd"></p>
</td></tr>
<tr>
<td><p class="starttd"><b>Description</b><br  />
</p>
<p class="endtd">The first step in coding a hierarchical state machine based on the <a class="el" href="struct_q_msm.html" title="Hierarchical State Machine class (QMsm-style state machine implementation strategy)">QMsm</a> implementation is to declare a subclass of the <a class="el" href="struct_q_msm.html" title="Hierarchical State Machine class (QMsm-style state machine implementation strategy)">QMsm</a> or the <a class="el" href="struct_q_m_active.html" title="Active object class (based on QMsm implementation strategy)">QMActive</a> base class. </p>
</td></tr>
<tr>
<td><p class="starttd"><b>Example</b><br  />
</p>
<p class="intertd">The following snippet of code shows the complete declaration of the <code>ToasterOven</code> subclass of <a class="el" href="struct_q_msm.html" title="Hierarchical State Machine class (QMsm-style state machine implementation strategy)">QMsm</a> shown in <a class="el" href="#sds-qp_fig-sm">Figure SDS-SM</a>:  </p><div class="fragment"><div class="line">[1]  <span class="keyword">typedef</span> <span class="keyword">struct </span>{</div>
<div class="line">     <span class="comment">// protected:</span></div>
<div class="line">[2]      <a class="code hl_class" href="struct_q_msm.html">QMsm</a> super;</div>
<div class="line"> </div>
<div class="line">     <span class="comment">// private:</span></div>
<div class="line">[3]      uint32_t settings;</div>
<div class="line">         uint16_t temp;</div>
<div class="line">         <a class="code hl_class" href="struct_q_time_evt.html">QTimeEvt</a> te;</div>
<div class="line"> </div>
<div class="line">     <span class="comment">// private state histories</span></div>
<div class="line">[4]      <a class="code hl_struct" href="struct_q_m_state.html">QMState</a> <span class="keyword">const</span> *hist_doorClosed;</div>
<div class="line">[1]  } ToasterOven;</div>
<div class="line"> </div>
<div class="line">     <span class="comment">// public:</span></div>
<div class="line">[10] <span class="keywordtype">void</span> ToasterOven_ctor(ToasterOven * <span class="keyword">const</span> me) {</div>
<div class="line">         QHsm_ctor(&amp;me-&gt;super, <a class="code hl_define" href="qp_8h.html#a6531b0ab582f41275f19d28ac91d9e4f">Q_STATE_CAST</a>(&amp;ToasterOven_initial));</div>
<div class="line">         QTimeEvt_ctorX(&amp;me-&gt;te, &amp;me-&gt;super, TIMEOUT_SIG, 0U),</div>
<div class="line">     }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// protected:</span></div>
<div class="line">[20] <a class="code hl_typedef" href="qp_8h.html#ad141f4e9efcba4613f82a8b2c76663ad">QState</a> ToasterOven_initial(ToasterOven * <span class="keyword">const</span> me, <span class="keywordtype">void</span> <span class="keyword">const</span> * <span class="keyword">const</span> par);</div>
<div class="line"> </div>
<div class="line">[30] <a class="code hl_typedef" href="qp_8h.html#ad141f4e9efcba4613f82a8b2c76663ad">QState</a> ToasterOven_doorClosed  (ToasterOven * <span class="keyword">const</span> me, <a class="code hl_class" href="struct_q_evt.html">QEvt</a> <span class="keyword">const</span> * <span class="keyword">const</span> e);</div>
<div class="line">[31] <a class="code hl_typedef" href="qp_8h.html#ad141f4e9efcba4613f82a8b2c76663ad">QState</a> ToasterOven_doorClosed_e(ToasterOven * <span class="keyword">const</span> me);</div>
<div class="line">[32] <a class="code hl_typedef" href="qp_8h.html#ad141f4e9efcba4613f82a8b2c76663ad">QState</a> ToasterOven_doorClosed_x(ToasterOven * <span class="keyword">const</span> me);</div>
<div class="line">[33] <a class="code hl_typedef" href="qp_8h.html#ad141f4e9efcba4613f82a8b2c76663ad">QState</a> ToasterOven_doorClosed_i(ToasterOven * <span class="keyword">const</span> me);</div>
<div class="line">[34] <span class="keyword">extern</span> <a class="code hl_struct" href="struct_q_m_state.html">QMState</a> <span class="keyword">const</span> ToasterOven_doorClosed_s;</div>
<div class="line"> </div>
<div class="line">     <a class="code hl_typedef" href="qp_8h.html#ad141f4e9efcba4613f82a8b2c76663ad">QState</a> ToasterOven_heating  (ToasterOven * <span class="keyword">const</span> me, <a class="code hl_class" href="struct_q_evt.html">QEvt</a> <span class="keyword">const</span> * <span class="keyword">const</span> e);</div>
<div class="line">     <a class="code hl_typedef" href="qp_8h.html#ad141f4e9efcba4613f82a8b2c76663ad">QState</a> ToasterOven_heating_e(ToasterOven * <span class="keyword">const</span> me);</div>
<div class="line">     <a class="code hl_typedef" href="qp_8h.html#ad141f4e9efcba4613f82a8b2c76663ad">QState</a> ToasterOven_heating_x(ToasterOven * <span class="keyword">const</span> me);</div>
<div class="line">     <a class="code hl_typedef" href="qp_8h.html#ad141f4e9efcba4613f82a8b2c76663ad">QState</a> ToasterOven_heating_i(ToasterOven * <span class="keyword">const</span> me);</div>
<div class="line">     <span class="keyword">extern</span> <a class="code hl_struct" href="struct_q_m_state.html">QMState</a> <span class="keyword">const</span> ToasterOven_heating_s;</div>
<div class="line"> </div>
<div class="line">     <a class="code hl_typedef" href="qp_8h.html#ad141f4e9efcba4613f82a8b2c76663ad">QState</a> ToasterOven_toasting  (ToasterOven * <span class="keyword">const</span> me, <a class="code hl_class" href="struct_q_evt.html">QEvt</a> <span class="keyword">const</span> * <span class="keyword">const</span> e);</div>
<div class="line">     <a class="code hl_typedef" href="qp_8h.html#ad141f4e9efcba4613f82a8b2c76663ad">QState</a> ToasterOven_toasting_e(ToasterOven * <span class="keyword">const</span> me);</div>
<div class="line">     <span class="keyword">extern</span> <a class="code hl_struct" href="struct_q_m_state.html">QMState</a> <span class="keyword">const</span> ToasterOven_toasting_s;</div>
<div class="line"> </div>
<div class="line">     <a class="code hl_typedef" href="qp_8h.html#ad141f4e9efcba4613f82a8b2c76663ad">QState</a> ToasterOven_baking  (ToasterOven * <span class="keyword">const</span> me, <a class="code hl_class" href="struct_q_evt.html">QEvt</a> <span class="keyword">const</span> * <span class="keyword">const</span> e);</div>
<div class="line">     <a class="code hl_typedef" href="qp_8h.html#ad141f4e9efcba4613f82a8b2c76663ad">QState</a> ToasterOven_baking_e(ToasterOven * <span class="keyword">const</span> me);</div>
<div class="line">     <span class="keyword">extern</span> <a class="code hl_struct" href="struct_q_m_state.html">QMState</a> <span class="keyword">const</span> ToasterOven_baking_s;</div>
<div class="line"> </div>
<div class="line">     <a class="code hl_typedef" href="qp_8h.html#ad141f4e9efcba4613f82a8b2c76663ad">QState</a> ToasterOven_off  (ToasterOven * <span class="keyword">const</span> me, <a class="code hl_class" href="struct_q_evt.html">QEvt</a> <span class="keyword">const</span> * <span class="keyword">const</span> e);</div>
<div class="line">     <a class="code hl_typedef" href="qp_8h.html#ad141f4e9efcba4613f82a8b2c76663ad">QState</a> ToasterOven_off_e(ToasterOven * <span class="keyword">const</span> me);</div>
<div class="line">     <span class="keyword">extern</span> <a class="code hl_struct" href="struct_q_m_state.html">QMState</a> <span class="keyword">const</span> ToasterOven_off_s;</div>
<div class="line"> </div>
<div class="line">     <a class="code hl_typedef" href="qp_8h.html#ad141f4e9efcba4613f82a8b2c76663ad">QState</a> ToasterOven_doorOpen  (ToasterOven * <span class="keyword">const</span> me, <a class="code hl_class" href="struct_q_evt.html">QEvt</a> <span class="keyword">const</span> * <span class="keyword">const</span> e);</div>
<div class="line">     <a class="code hl_typedef" href="qp_8h.html#ad141f4e9efcba4613f82a8b2c76663ad">QState</a> ToasterOven_doorOpen_e(ToasterOven * <span class="keyword">const</span> me);</div>
<div class="line">     <a class="code hl_typedef" href="qp_8h.html#ad141f4e9efcba4613f82a8b2c76663ad">QState</a> ToasterOven_doorOpen_x(ToasterOven * <span class="keyword">const</span> me);</div>
<div class="line">     <span class="keyword">extern</span> <a class="code hl_struct" href="struct_q_m_state.html">QMState</a> <span class="keyword">const</span> ToasterOven_doorOpen_s;</div>
<div class="line"> </div>
<div class="line">     <span class="comment">// private:</span></div>
<div class="line">[40] <span class="keywordtype">void</span> ToasterOven_actionA(ToasterOven * <span class="keyword">const</span> me);</div>
<div class="line">     <span class="keywordtype">void</span> ToasterOven_actionB(ToasterOven * <span class="keyword">const</span> me);</div>
<div class="ttc" id="astruct_q_m_state_html"><div class="ttname"><a href="struct_q_m_state.html">QMState</a></div><div class="ttdoc">State object for the QMsm class (QM State Machine)</div><div class="ttdef"><b>Definition</b> <a href="qp_8h_source.html#l00154">qp.h:154</a></div></div>
<div class="ttc" id="astruct_q_msm_html"><div class="ttname"><a href="struct_q_msm.html">QMsm</a></div><div class="ttdoc">Hierarchical State Machine class (QMsm-style state machine implementation strategy)</div><div class="ttdef"><b>Definition</b> <a href="qp_8h_source.html#l00314">qp.h:314</a></div></div>
</div><!-- fragment --><p> <code>[1]</code> Declaration of class <code>ToasterOven</code></p>
<p class="intertd"><code>[2]</code> Class <code>ToasterOven</code> inherits <a class="el" href="struct_q_msm.html" title="Hierarchical State Machine class (QMsm-style state machine implementation strategy)">QMsm</a>, so it can have a state machine that must be implemented according to the rules specified in the <a class="el" href="#sds-qp_state-msm">QMsm Design View</a>. </p><dl class="section note"><dt>Note</dt><dd>The state machine implementation is identical, whether it inherits <a class="el" href="struct_q_msm.html" title="Hierarchical State Machine class (QMsm-style state machine implementation strategy)">QMsm</a>, <a class="el" href="struct_q_m_active.html" title="Active object class (based on QMsm implementation strategy)">QMActive</a>, or subclasses of these base classes.</dd></dl>
<p><code>[3]</code> The class can have data members (typically private), which will be accessible inside the state machine as the "extended-state variables".</p>
<p class="intertd"><code>[4]</code> If the state machine uses state history (<a class="el" href="#sds-qp_fig-sm">Figure SDS-SM [11]</a>), a data member must be provided to remember each state's history.</p>
<p class="intertd"><a class="anchor" id="qpcpp-msm_ctor"></a><code>[10]</code> The class needs to provide a <em>constructor</em>, typically without any parameters. </p><dl class="section note"><dt>Note</dt><dd>The role of the constructor is just to initialize the state machine instance to bind it to the top-most initial pseudo-state (see step <code>[5]</code>). Most other data members are initialized in the top-most initial transition, which is taken later, when when the state machine is initialized (see <a class="el" href="#SDS_QA_QHsm_top_init">SDS_QA_QHsm_top_init</a>).</dd></dl>
<p><code>[11]</code> The class <em>constructor</em>, must call the superclass' constructor (<a class="el" href="struct_q_msm.html#ae3734745028e390aa776e2b59c5716c8">QMsm_ctor()</a> constructor in this case). The superclass' constructor initializes this state machine to the top-most initial pseudostate declared in step <code>[20]</code>.</p>
<p class="intertd"><code>[12]</code> The class <em>constructor</em>, must call the constructors of its data members, if such constructors exist.</p>
<p class="intertd"><code>[20]</code> Each state machine must have exactly one initial pseudo-state, which is a member function of the class as shown in the listing. By convention, the initial pseudo-state should be always called <code>initial</code>.</p>
<p class="intertd"><code>[30-34]</code> States are represented as a group of member functions of the state machine class plus a <a class="el" href="struct_q_m_state.html" title="State object for the QMsm class (QM State Machine)">QMState</a> data structure. The member functions are as follows:</p><ul>
<li><code>[30]</code> state-handler for all transitions (including internal transitions)</li>
<li><code>[31]</code> state action handler for state entry</li>
<li><code>[32]</code> state action handler for state exit</li>
<li><code>[33]</code> state action handler for nested initial transition within this state</li>
<li><code>[34]</code> state object that summarizes the information about this state (const in ROM)</li>
</ul>
<dl class="section note"><dt>Note</dt><dd>Only state actions actually used by the state are declared. For example, state <code>ToasterOven_toasting</code> does not have an exit action, so it does not define the <code>ToasterOven_toasting_x</code> action function. </dd>
<dd>
All states are declared the same way regardless of their nesting level.</dd></dl>
<p><code>[40]</code> The class might also provide any number of action functions that will be called in the state machine.  </p>
</td></tr>
<tr>
<td><p class="starttd"><b>Backward Traceability</b><br  />
</p>
<ul>
<li><a class="el" href="sas-qp_ctxt.html#SAS_QP_FRM">SAS_QP_FRM</a>: <em>QP Framework layer</em> </li>
</ul>
</td></tr>
<tr>
<td><p class="starttd"><b>Forward Traceability (truncated to 2 level(s))</b><br  />
</p>
<p class="endtd"></p>
</td></tr>
</table>
<p><a id="a151_SDS_5FQA_5FQMsm_5Ftop_5Finit" name="a151_SDS_5FQA_5FQMsm_5Ftop_5Finit"></a> </p>
<h2><a class="anchor" id="SDS_QA_QMsm_top_init"></a>
SDS_QA_QMsm_top_init</h2>
<table class="doxtable">
<tr>
<td style="text-align:left; width:var(--content-maxwidth)"><p class="starttd"><b>SDS_QA_QMsm_top_init</b>: <em>Implementing the top-most initial pseudo-state.</em></p>
<p class="endtd"></p>
</td></tr>
<tr>
<td><p class="starttd"><b>Description</b><br  />
</p>
<p class="endtd">The top-most initial pseudostate is a member function of the sate machine class (see <a class="el" href="#sds-qp_fig-sm">Figure SDS-SM [1]</a>). This pseudostate defines the top-most initial transition, which will be taken when the state machine is initialized (see <a class="el" href="sds-qp_struct.html#SDS_QP_QAsm">SDS_QP_QAsm</a> interface <code>init()</code> function). </p>
</td></tr>
<tr>
<td><p class="starttd"><b>Example</b><br  />
</p>
<p class="intertd">The following example code shows a top-most initial pseudo-state function with various elements explained in the labeled annotations following the listing.  </p><div class="fragment"><div class="line">[1]  <a class="code hl_typedef" href="qp_8h.html#ad141f4e9efcba4613f82a8b2c76663ad">QState</a> ToasterOven_initial(ToasterOven * <span class="keyword">const</span> me, <span class="keywordtype">void</span> <span class="keyword">const</span> * <span class="keyword">const</span> par) {</div>
<div class="line">[2]      me-&gt;setting = DEFAULT_SETTINGS;</div>
<div class="line">         me-&gt;temp = BSP_temp();</div>
<div class="line">         <span class="comment">// state history attributes</span></div>
<div class="line">[3]      me-&gt;hist_doorClosed = &amp;ToasterOven_off_s;</div>
<div class="line"> </div>
<div class="line">[4]      <a class="code hl_define" href="qs__dummy_8h.html#a3b1ab21c174f2bec448edec8865a8529">QS_FUN_DICTIONARY</a>(&amp;ToasterOven_doorClosed);</div>
<div class="line">         <a class="code hl_define" href="qs__dummy_8h.html#a3b1ab21c174f2bec448edec8865a8529">QS_FUN_DICTIONARY</a>(&amp;ToasterOven_off);</div>
<div class="line">         <a class="code hl_define" href="qs__dummy_8h.html#a3b1ab21c174f2bec448edec8865a8529">QS_FUN_DICTIONARY</a>(&amp;ToasterOven_heating);</div>
<div class="line">         <a class="code hl_define" href="qs__dummy_8h.html#a3b1ab21c174f2bec448edec8865a8529">QS_FUN_DICTIONARY</a>(&amp;ToasterOven_doorOpen);</div>
<div class="line">         <a class="code hl_define" href="qs__dummy_8h.html#a3b1ab21c174f2bec448edec8865a8529">QS_FUN_DICTIONARY</a>(&amp;ToasterOven_sm_heating_toasting);</div>
<div class="line">         <a class="code hl_define" href="qs__dummy_8h.html#a3b1ab21c174f2bec448edec8865a8529">QS_FUN_DICTIONARY</a>(&amp;ToasterOven_sm_heating_baking);</div>
<div class="line">         <a class="code hl_define" href="qs__dummy_8h.html#a3b1ab21c174f2bec448edec8865a8529">QS_FUN_DICTIONARY</a>(&amp;ToasterOven_sm_heating);</div>
<div class="line"> </div>
<div class="line">         <span class="keyword">static</span> <span class="keyword">struct </span>{</div>
<div class="line">             <a class="code hl_struct" href="struct_q_m_state.html">QMState</a> <span class="keyword">const</span> *target;</div>
<div class="line">             <a class="code hl_typedef" href="qp_8h.html#ae6ffc980f83c8e9dc039dba0521ae856">QActionHandler</a> act[3];</div>
<div class="line">[5]      } <span class="keyword">const</span> tatbl_ = { <span class="comment">// tran-action table</span></div>
<div class="line">[6]          &amp;ToasterOven_doorClosed_s, <span class="comment">// target state</span></div>
<div class="line">             {</div>
<div class="line">[7]              <a class="code hl_define" href="qp_8h.html#a7e1de8a050ac4678150ab96607c249fd">Q_ACTION_CAST</a>(&amp;ToasterOven_doorClosed_e), <span class="comment">// entry</span></div>
<div class="line">[8]              <a class="code hl_define" href="qp_8h.html#a7e1de8a050ac4678150ab96607c249fd">Q_ACTION_CAST</a>(&amp;ToasterOven_doorClosed_i), <span class="comment">// initial tran.</span></div>
<div class="line">[9]              <a class="code hl_define" href="qp_8h.html#aeb993294cc885215f15c5d1238e8d392">Q_ACTION_NULL</a> <span class="comment">// zero terminator</span></div>
<div class="line">             }</div>
<div class="line">         };</div>
<div class="line">[10]     <span class="keywordflow">return</span> <a class="code hl_define" href="qp_8h.html#a354ec4f0ce78c6dce35b515ee7917c51">QM_TRAN_INIT</a>(&amp;tatbl_);</div>
<div class="line">     }</div>
<div class="ttc" id="aqp_8h_html_a354ec4f0ce78c6dce35b515ee7917c51"><div class="ttname"><a href="qp_8h.html#a354ec4f0ce78c6dce35b515ee7917c51">QM_TRAN_INIT</a></div><div class="ttdeci">#define QM_TRAN_INIT(tatbl_)</div><div class="ttdoc">Macro to call in a QM state-handler when it executes an initial transition. Applicable only to QMsm s...</div><div class="ttdef"><b>Definition</b> <a href="qp_8h_source.html#l00369">qp.h:369</a></div></div>
<div class="ttc" id="aqp_8h_html_a7e1de8a050ac4678150ab96607c249fd"><div class="ttname"><a href="qp_8h.html#a7e1de8a050ac4678150ab96607c249fd">Q_ACTION_CAST</a></div><div class="ttdeci">#define Q_ACTION_CAST(action_)</div><div class="ttdoc">Perform cast to QActionHandler.</div><div class="ttdef"><b>Definition</b> <a href="qp_8h_source.html#l00176">qp.h:176</a></div></div>
<div class="ttc" id="aqp_8h_html_ae6ffc980f83c8e9dc039dba0521ae856"><div class="ttname"><a href="qp_8h.html#ae6ffc980f83c8e9dc039dba0521ae856">QActionHandler</a></div><div class="ttdeci">QState(* QActionHandler)(void *const me)</div><div class="ttdoc">Pointer to an action-handler function.</div><div class="ttdef"><b>Definition</b> <a href="qp_8h_source.html#l00149">qp.h:149</a></div></div>
<div class="ttc" id="aqp_8h_html_aeb993294cc885215f15c5d1238e8d392"><div class="ttname"><a href="qp_8h.html#aeb993294cc885215f15c5d1238e8d392">Q_ACTION_NULL</a></div><div class="ttdeci">#define Q_ACTION_NULL</div><div class="ttdoc">Macro to provide strictly-typed zero-action to terminate action lists in the transition-action-tables...</div><div class="ttdef"><b>Definition</b> <a href="qp_8h_source.html#l00177">qp.h:177</a></div></div>
</div><!-- fragment --><p> <code>[1]</code> The top-most initial pseudostate function signature (see also <a class="el" href="#SDS_QA_QMsm_decl">SDS_QA_QMsm_decl</a> [9])</p>
<p class="intertd"><code>[2]</code> The top-most initial pseudostate initializes internal variables (see also <a class="el" href="#SDS_QA_QMsm_decl">SDS_QA_QMsm_decl</a> [3])</p>
<p class="intertd"><code>[3]</code> The top-most initial pseudostate initializes state histories for all states with history (see also <a class="el" href="#SDS_QA_QMsm_hist">SDS_QA_QMsm_hist</a>)</p>
<p class="intertd"><code>[4]</code> If <a class="el" href="class_q_s.html" title="Software tracing instrumentation, target-resident component (QS namespace emulated as a &quot;class&quot; in C)">QS</a> software tracing is used, the top-most initial pseudostate produces function dictionaries for all its state-handler functions</p>
<p class="intertd"><code>[5-9]</code> The top-most initial pseudostate declares a static and const struct called "tran-action table", which specifies the sequence of actions to execute:</p><ul>
<li><code>[6]</code> the target state of the initial transition</li>
<li><code>[7]</code> the entry action to that target state</li>
<li><code>[8]</code> the nested initial transition in that target state</li>
<li><code>[9]</code> the "zero terminator" that indicates the end of the "tran-action table"</li>
</ul>
<dl class="section note"><dt>Note</dt><dd>The "tran-action table" speeds up the transition execution because all actions are preconfigured at compile-time rather than being discovered at runtime as in the case of the QHsm-based state machine implementation strategy. Being defined as both `static` and `const`, the "tran-action table" can be allocated in ROM and takes no precious RAM.</dd></dl>
<p><code>[10]</code> The top-most initial pseudostate must end with the top-most initial transition, which is coded with the <a class="el" href="qp_8h.html#a354ec4f0ce78c6dce35b515ee7917c51" title="Macro to call in a QM state-handler when it executes an initial transition. Applicable only to QMsm s...">QM_TRAN_INIT()</a> macro. The argument of this macro is the "tran-action table" specified in steps <code>[5-9]</code> (see also <a class="el" href="#sds-qp_fig-sm">Figure SDS-SM [1]</a>)  </p>
</td></tr>
<tr>
<td><p class="starttd"><b>Backward Traceability</b><br  />
</p>
<ul>
<li><a class="el" href="sas-qp_ctxt.html#SAS_QP_FRM">SAS_QP_FRM</a>: <em>QP Framework layer</em> </li>
</ul>
</td></tr>
<tr>
<td><p class="starttd"><b>Forward Traceability (truncated to 2 level(s))</b><br  />
</p>
<p class="endtd"></p>
</td></tr>
</table>
<p><a id="a152_SDS_5FQA_5FQMsm_5Fstate" name="a152_SDS_5FQA_5FQMsm_5Fstate"></a> </p>
<h2><a class="anchor" id="SDS_QA_QMsm_state"></a>
SDS_QA_QMsm_state</h2>
<table class="doxtable">
<tr>
<td style="text-align:left; width:var(--content-maxwidth)"><p class="starttd"><b>SDS_QA_QMsm_state</b>: <em>Implementing a state and its nesting.</em></p>
<p class="endtd"></p>
</td></tr>
<tr>
<td><p class="starttd"><b>Description</b><br  />
</p>
<p class="intertd">States in the QMsm-based implementation strategy are const data structures of type <a class="el" href="struct_q_m_state.html" title="State object for the QMsm class (QM State Machine)">QMState</a> that store:</p><ol type="1">
<li>superstate of a given state</li>
<li>state-handler function</li>
<li>state entry action function</li>
<li>state exit action function</li>
<li>state initial action function</li>
</ol>
<p class="endtd">The QP event processor uses this information to perform state transitions according to the hierarchical state machine semantics specified in <a class="el" href="srs-qp_sm.html#SRS_QP_SM_30">SRS_QP_SM_30</a>. Specifically, the action functions are called through the "tran-action tables" to exit the previous state configuration and enter the next state configuration. </p>
</td></tr>
<tr>
<td><p class="starttd"><b>Example</b><br  />
</p>
<p class="intertd">The following example code shows two state data structures and the corresponding state-handler functions. The first one implements a top-level state. The second one implements a state that is explicitly nested in another state. </p><dl class="section note"><dt>Note</dt><dd>The general structure of state-handler functions is the same regardless of their nesting level.</dd></dl>
<div class="fragment"><div class="line">     <span class="comment">// top-level state</span></div>
<div class="line">[1]  <a class="code hl_struct" href="struct_q_m_state.html">QMState</a> <span class="keyword">const</span> ToasterOven_doorClosed_s = {</div>
<div class="line">[2a]     <a class="code hl_define" href="qp_8h.html#abc3b399c7545e18255f8e57f3f60fbf9">QM_STATE_NULL</a>, <span class="comment">// superstate (top)</span></div>
<div class="line">[3]      <a class="code hl_define" href="qp_8h.html#a6531b0ab582f41275f19d28ac91d9e4f">Q_STATE_CAST</a>(&amp;ToasterOven_doorClosed),</div>
<div class="line">[4]      <a class="code hl_define" href="qp_8h.html#a7e1de8a050ac4678150ab96607c249fd">Q_ACTION_CAST</a>(&amp;ToasterOven_doorClosed_e),</div>
<div class="line">[5]      <a class="code hl_define" href="qp_8h.html#a7e1de8a050ac4678150ab96607c249fd">Q_ACTION_CAST</a>(&amp;ToasterOven_doorClosed_x),</div>
<div class="line">[6]      <a class="code hl_define" href="qp_8h.html#a7e1de8a050ac4678150ab96607c249fd">Q_ACTION_CAST</a>(&amp;ToasterOven_doorClosed_i)</div>
<div class="line">     };</div>
<div class="line"> </div>
<div class="line">[10] <a class="code hl_typedef" href="qp_8h.html#ad141f4e9efcba4613f82a8b2c76663ad">QState</a> ToasterOven_doorClosed(ToasterOven * <span class="keyword">const</span> me, <a class="code hl_class" href="struct_q_evt.html">QEvt</a> <span class="keyword">const</span> * <span class="keyword">const</span> e) {</div>
<div class="line">[11]     <a class="code hl_typedef" href="qp_8h.html#ad141f4e9efcba4613f82a8b2c76663ad">QState</a> status_;</div>
<div class="line">[12]     <span class="keywordflow">switch</span> (e-&gt;<a class="code hl_variable" href="struct_q_evt.html#a20b1ceebb91aea39fcbc633aeae6cd3f">sig</a>) {</div>
<div class="line">             . . .</div>
<div class="line">[13]         <span class="keywordflow">default</span>: {</div>
<div class="line">[14]             status_ = <a class="code hl_define" href="qp_8h.html#a94c192e5d5d8576eac408836e5bdc39d">QM_SUPER</a>();</div>
<div class="line">                 <span class="keywordflow">break</span>;</div>
<div class="line">             }</div>
<div class="line">         }</div>
<div class="line">[15]     <span class="keywordflow">return</span> status_;</div>
<div class="line">     }</div>
<div class="line"> </div>
<div class="line">     <span class="comment">// state nested in another state</span></div>
<div class="line">[1]  <a class="code hl_struct" href="struct_q_m_state.html">QMState</a> <span class="keyword">const</span> ToasterOven_off_s = {</div>
<div class="line">[2b]     &amp;ToasterOven_doorClosed_s, <span class="comment">// superstate doorClosed</span></div>
<div class="line">[3]      <a class="code hl_define" href="qp_8h.html#a6531b0ab582f41275f19d28ac91d9e4f">Q_STATE_CAST</a>(&amp;ToasterOven_off),</div>
<div class="line">[4]      <a class="code hl_define" href="qp_8h.html#a7e1de8a050ac4678150ab96607c249fd">Q_ACTION_CAST</a>(&amp;ToasterOven_off_e),</div>
<div class="line">[5]      <a class="code hl_define" href="qp_8h.html#aeb993294cc885215f15c5d1238e8d392">Q_ACTION_NULL</a>, <span class="comment">// no exit action</span></div>
<div class="line">[6]      <a class="code hl_define" href="qp_8h.html#aeb993294cc885215f15c5d1238e8d392">Q_ACTION_NULL</a>  <span class="comment">// no initial tran.</span></div>
<div class="line">     };</div>
<div class="line"> </div>
<div class="line">[10] <a class="code hl_typedef" href="qp_8h.html#ad141f4e9efcba4613f82a8b2c76663ad">QState</a> ToasterOven_off(ToasterOven * <span class="keyword">const</span> me, <a class="code hl_class" href="struct_q_evt.html">QEvt</a> <span class="keyword">const</span> * <span class="keyword">const</span> e) {</div>
<div class="line">[11]     <a class="code hl_typedef" href="qp_8h.html#ad141f4e9efcba4613f82a8b2c76663ad">QState</a> status_;</div>
<div class="line">[12]      <span class="keywordflow">switch</span> (e-&gt;<a class="code hl_variable" href="struct_q_evt.html#a20b1ceebb91aea39fcbc633aeae6cd3f">sig</a>) {</div>
<div class="line">             . . .</div>
<div class="line">[13]         <span class="keywordflow">default</span>: {</div>
<div class="line">[14]             status_ = <a class="code hl_define" href="qp_8h.html#a94c192e5d5d8576eac408836e5bdc39d">QM_SUPER</a>();</div>
<div class="line">                 <span class="keywordflow">break</span>;</div>
<div class="line">             }</div>
<div class="line">         }</div>
<div class="line">[15]     <span class="keywordflow">return</span> status_;</div>
<div class="line">     }</div>
<div class="ttc" id="aqp_8h_html_a94c192e5d5d8576eac408836e5bdc39d"><div class="ttname"><a href="qp_8h.html#a94c192e5d5d8576eac408836e5bdc39d">QM_SUPER</a></div><div class="ttdeci">#define QM_SUPER()</div><div class="ttdoc">Macro to call in a QM state-handler when it designates the superstate to handle an event....</div><div class="ttdef"><b>Definition</b> <a href="qp_8h_source.html#l00379">qp.h:379</a></div></div>
<div class="ttc" id="aqp_8h_html_abc3b399c7545e18255f8e57f3f60fbf9"><div class="ttname"><a href="qp_8h.html#abc3b399c7545e18255f8e57f3f60fbf9">QM_STATE_NULL</a></div><div class="ttdeci">#define QM_STATE_NULL</div><div class="ttdef"><b>Definition</b> <a href="qp_8h_source.html#l00380">qp.h:380</a></div></div>
</div><!-- fragment --><p> <code>[1-6]</code> The <code>const</code> state data struct for the <code>ToasterOven</code> state "doorClosed" is defined and initialized with:</p><ul>
<li><code>[2a]</code> The superstate of this state (<a class="el" href="qp_8h.html#abc3b399c7545e18255f8e57f3f60fbf9">QM_STATE_NULL</a> in case of a top-level state)</li>
<li><code>[2b]</code> The superstate of this state (pointer to the state data struct in case of a state nested in another state)</li>
<li><code>[3]</code> The state-handler function pointer to process application-defined events</li>
<li><code>[4]</code> The action-handler function pointer to execute upon the entry to the state (might be <a class="el" href="qp_8h.html#aeb993294cc885215f15c5d1238e8d392" title="Macro to provide strictly-typed zero-action to terminate action lists in the transition-action-tables...">Q_ACTION_NULL</a>)</li>
<li><code>[5]</code> The action-handler function pointer to execute upon the exit from the state (might be <a class="el" href="qp_8h.html#aeb993294cc885215f15c5d1238e8d392" title="Macro to provide strictly-typed zero-action to terminate action lists in the transition-action-tables...">Q_ACTION_NULL</a>)</li>
<li><code>[6]</code> The action-handler function pointer to execute upon the nested initial transition in the state (might be <a class="el" href="qp_8h.html#aeb993294cc885215f15c5d1238e8d392" title="Macro to provide strictly-typed zero-action to terminate action lists in the transition-action-tables...">Q_ACTION_NULL</a>)</li>
</ul>
<p class="intertd"><code>[10]</code> The state-handler function to process application-defined events</p>
<p class="intertd"><code>[11]</code> The local status_ variable to return at the end of the state-handler function</p>
<p class="intertd"><code>[12]</code> The state-handler function is structured as a <code>switch</code> statement that discriminates based on the signal of the current event <code>e-&gt;sig</code> (see <a class="el" href="sds-qp_struct.html#SDS_QP_QEvt">SDS_QP_QEvt</a>).</p>
<p class="intertd"><code>[13]</code> The <code>switch</code> must always have the default case, which should be executed <b>without side effects</b>.</p>
<p class="endtd"><code>[14]</code> The default case must set the <code>status_</code> to the macro <a class="el" href="qp_8h.html#a94c192e5d5d8576eac408836e5bdc39d" title="Macro to call in a QM state-handler when it designates the superstate to handle an event....">QM_SUPER()</a>.  </p>
</td></tr>
<tr>
<td><p class="starttd"><b>Backward Traceability</b><br  />
</p>
<ul>
<li><a class="el" href="sas-qp_ctxt.html#SAS_QP_FRM">SAS_QP_FRM</a>: <em>QP Framework layer</em> </li>
</ul>
</td></tr>
<tr>
<td><p class="starttd"><b>Forward Traceability (truncated to 2 level(s))</b><br  />
</p>
<p class="endtd"></p>
</td></tr>
</table>
<p><a id="a153_SDS_5FQA_5FQMsm_5Fentry" name="a153_SDS_5FQA_5FQMsm_5Fentry"></a> </p>
<h2><a class="anchor" id="SDS_QA_QMsm_entry"></a>
SDS_QA_QMsm_entry</h2>
<table class="doxtable">
<tr>
<td style="text-align:left; width:var(--content-maxwidth)"><p class="starttd"><b>SDS_QA_QMsm_entry</b>: <em>Implementing state entry action.</em></p>
<p class="endtd"></p>
</td></tr>
<tr>
<td><p class="starttd"><b>Description</b><br  />
</p>
<p class="endtd">State entry action (see <a class="el" href="#sds-qp_fig-sm">Figure SDS-SM [3]</a>) is coded as a separate member function of the state machine class. The QP event processor executes this state-entry action function through the "tran-action table" when a state transition is taken. Please note that the state-entry action function has no access to the original event that triggered the state transition. </p>
</td></tr>
<tr>
<td><p class="starttd"><b>Example</b><br  />
</p>
<p class="intertd">The following example code shows a state-handler function with an entry action.  </p><div class="fragment"><div class="line">[1]  <a class="code hl_typedef" href="qp_8h.html#ad141f4e9efcba4613f82a8b2c76663ad">QState</a> ToasterOven_doorClosed_e(ToasterOven * <span class="keyword">const</span> me) {</div>
<div class="line">[2]      <span class="comment">// any actions...</span></div>
<div class="line">[3]      <span class="keywordflow">return</span> <a class="code hl_define" href="qp_8h.html#a1ce3343989b290f23c91d9d0fc4dc542">QM_ENTRY</a>(&amp;ToasterOven_doorClosed_s);</div>
<div class="line">     }</div>
<div class="ttc" id="aqp_8h_html_a1ce3343989b290f23c91d9d0fc4dc542"><div class="ttname"><a href="qp_8h.html#a1ce3343989b290f23c91d9d0fc4dc542">QM_ENTRY</a></div><div class="ttdeci">#define QM_ENTRY(state_)</div><div class="ttdoc">Macro to call in a QM action-handler when it executes an entry action. Applicable only to QMsm subcla...</div><div class="ttdef"><b>Definition</b> <a href="qp_8h_source.html#l00357">qp.h:357</a></div></div>
</div><!-- fragment --><p> <code>[1]</code> The state-entry action function is a member of the state machine class.</p>
<p class="intertd"><code>[2]</code> The state action function calls all the actions to be executed upon the entry to the state.</p>
<p class="endtd"><code>[3]</code> The state-entry action function must return the <a class="el" href="qp_8h.html#a1ce3343989b290f23c91d9d0fc4dc542" title="Macro to call in a QM action-handler when it executes an entry action. Applicable only to QMsm subcla...">QM_ENTRY()</a> macro, with the argument being the state struct corresponding to the state being entered.  </p>
</td></tr>
<tr>
<td><p class="starttd"><b>Backward Traceability</b><br  />
</p>
<ul>
<li><a class="el" href="sas-qp_ctxt.html#SAS_QP_FRM">SAS_QP_FRM</a>: <em>QP Framework layer</em> </li>
</ul>
</td></tr>
<tr>
<td><p class="starttd"><b>Forward Traceability (truncated to 2 level(s))</b><br  />
</p>
<p class="endtd"></p>
</td></tr>
</table>
<p><a id="a154_SDS_5FQA_5FQMsm_5Fexit" name="a154_SDS_5FQA_5FQMsm_5Fexit"></a> </p>
<h2><a class="anchor" id="SDS_QA_QMsm_exit"></a>
SDS_QA_QMsm_exit</h2>
<table class="doxtable">
<tr>
<td style="text-align:left; width:var(--content-maxwidth)"><p class="starttd"><b>SDS_QA_QMsm_exit</b>: <em>Implementing state exit action.</em></p>
<p class="endtd"></p>
</td></tr>
<tr>
<td><p class="starttd"><b>Description</b><br  />
</p>
<p class="endtd">State exit action (see <a class="el" href="#sds-qp_fig-sm">Figure SDS-SM [3]</a>) is coded as a separate member function of the state machine class. The QP event processor executes this state-exit action function through the "tran-action table" when a state transition is taken. Please note that the state-exit action function has no access to the original event that triggered the state transition. </p>
</td></tr>
<tr>
<td><p class="starttd"><b>Example</b><br  />
</p>
<p class="intertd">The following example code shows a state-handler function with an exit action.  </p><div class="fragment"><div class="line">[1]  <a class="code hl_typedef" href="qp_8h.html#ad141f4e9efcba4613f82a8b2c76663ad">QState</a> ToasterOven_doorClosed_x(ToasterOven * <span class="keyword">const</span> me) {</div>
<div class="line">[2]      <span class="comment">// any actions...</span></div>
<div class="line">[3]      me-&gt;hist_doorClosed = QMsm_stateObj(<a class="code hl_define" href="qp_8h.html#a02785363be76278f9215a0bab212e445">Q_MSM_UPCAST</a>(me));</div>
<div class="line">[4]      <span class="keywordflow">return</span> <a class="code hl_define" href="qp_8h.html#af44f060a04828a0d25a99f11dd078f4f">QM_EXIT</a>(&amp;ToasterOven_doorClosed_s);</div>
<div class="line">     }</div>
<div class="ttc" id="aqp_8h_html_a02785363be76278f9215a0bab212e445"><div class="ttname"><a href="qp_8h.html#a02785363be76278f9215a0bab212e445">Q_MSM_UPCAST</a></div><div class="ttdeci">#define Q_MSM_UPCAST(ptr_)</div><div class="ttdoc">Perform upcasting from a subclass of QMsm to the base class QMsm.</div><div class="ttdef"><b>Definition</b> <a href="qp_8h_source.html#l00355">qp.h:355</a></div></div>
<div class="ttc" id="aqp_8h_html_af44f060a04828a0d25a99f11dd078f4f"><div class="ttname"><a href="qp_8h.html#af44f060a04828a0d25a99f11dd078f4f">QM_EXIT</a></div><div class="ttdeci">#define QM_EXIT(state_)</div><div class="ttdoc">Macro to call in a QM action-handler when it executes an exit action. Applicable only to QMsm subclas...</div><div class="ttdef"><b>Definition</b> <a href="qp_8h_source.html#l00359">qp.h:359</a></div></div>
</div><!-- fragment --><p> <code>[1]</code> The state-exit action function is a member of the state machine class.</p>
<p class="intertd"><code>[2]</code> The state action function calls all the actions to be executed upon the exit from the state.</p>
<p class="intertd"><code>[3]</code> If the state has a history transition, the state-exit action function must set the state history variable.</p>
<p class="endtd"><code>[4]</code> The state-exit action function must return the <a class="el" href="qp_8h.html#af44f060a04828a0d25a99f11dd078f4f" title="Macro to call in a QM action-handler when it executes an exit action. Applicable only to QMsm subclas...">QM_EXIT()</a> macro, with the argument being the state struct corresponding to the state being exited.  </p>
</td></tr>
<tr>
<td><p class="starttd"><b>Backward Traceability</b><br  />
</p>
<ul>
<li><a class="el" href="sas-qp_ctxt.html#SAS_QP_FRM">SAS_QP_FRM</a>: <em>QP Framework layer</em> </li>
</ul>
</td></tr>
<tr>
<td><p class="starttd"><b>Forward Traceability (truncated to 2 level(s))</b><br  />
</p>
<p class="endtd"></p>
</td></tr>
</table>
<p><a id="a155_SDS_5FQA_5FQMsm_5Fnest_5Finit" name="a155_SDS_5FQA_5FQMsm_5Fnest_5Finit"></a> </p>
<h2><a class="anchor" id="SDS_QA_QMsm_nest_init"></a>
SDS_QA_QMsm_nest_init</h2>
<table class="doxtable">
<tr>
<td style="text-align:left; width:var(--content-maxwidth)"><p class="starttd"><b>SDS_QA_QMsm_nest_init</b>: <em>Implementing nested initial transition.</em></p>
<p class="endtd"></p>
</td></tr>
<tr>
<td><p class="starttd"><b>Description</b><br  />
</p>
<p class="endtd">Nested initial transition (see <a class="el" href="#sds-qp_fig-sm">Figure SDS-SM [5]</a>) is coded as a separate member function of the state machine class. The QP event processor executes this initial transition action function through the "tran-action table" when a state transition is taken. Please note that the initial transition function has no access to the original event that triggered the state transition. </p>
</td></tr>
<tr>
<td><p class="starttd"><b>Example</b><br  />
</p>
<p class="intertd">The following example code shows a initial transition function.  </p><div class="fragment"><div class="line">[1] <a class="code hl_typedef" href="qp_8h.html#ad141f4e9efcba4613f82a8b2c76663ad">QState</a> ToasterOven_doorClosed_i(ToasterOven * <span class="keyword">const</span> me) {</div>
<div class="line">[2]      me-&gt;temp = BSP_temp();</div>
<div class="line"> </div>
<div class="line">         <span class="keyword">static</span> <span class="keyword">struct </span>{</div>
<div class="line">             <a class="code hl_struct" href="struct_q_m_state.html">QMState</a> <span class="keyword">const</span> *target;</div>
<div class="line">             <a class="code hl_typedef" href="qp_8h.html#ae6ffc980f83c8e9dc039dba0521ae856">QActionHandler</a> act[2];</div>
<div class="line">[3]      } <span class="keyword">const</span> tatbl_ = { <span class="comment">// tran-action table</span></div>
<div class="line">[4]          &amp;ToasterOven_off_s, <span class="comment">// target state</span></div>
<div class="line">             {</div>
<div class="line">[5]              <a class="code hl_define" href="qp_8h.html#a7e1de8a050ac4678150ab96607c249fd">Q_ACTION_CAST</a>(&amp;ToasterOven_off_e), <span class="comment">// entry</span></div>
<div class="line">[6]              <a class="code hl_define" href="qp_8h.html#aeb993294cc885215f15c5d1238e8d392">Q_ACTION_NULL</a> <span class="comment">// zero terminator</span></div>
<div class="line">             }</div>
<div class="line">         };</div>
<div class="line">[7]      <span class="keywordflow">return</span> <a class="code hl_define" href="qp_8h.html#a354ec4f0ce78c6dce35b515ee7917c51">QM_TRAN_INIT</a>(&amp;tatbl_);</div>
<div class="line">     }</div>
</div><!-- fragment --><p> <code>[1]</code> The initial-transition function has the usual signature of an action-handler.</p>
<p class="intertd"><code>[2]</code> Any actions on this initial transition are executed</p>
<p class="intertd"><code>[3-6]</code> The static and const struct called "tran-action table" specifies the sequence of actions to execute:</p><ul>
<li><code>[4]</code> the target state of the initial transition</li>
<li><code>[5]</code> the entry action to that target state</li>
<li><code>[6]</code> the "zero terminator" that indicates the end of the "tran-action table"</li>
</ul>
<p class="endtd"><code>[7]</code> The initial transition function must end with the <a class="el" href="qp_8h.html#a354ec4f0ce78c6dce35b515ee7917c51" title="Macro to call in a QM state-handler when it executes an initial transition. Applicable only to QMsm s...">QM_TRAN_INIT()</a> macro. The argument of this macro is the "tran-action table" specified in steps <code>[3-6]</code> (see also <a class="el" href="#sds-qp_fig-sm">Figure SDS-SM [5]</a>).  </p>
</td></tr>
<tr>
<td><p class="starttd"><b>Backward Traceability</b><br  />
</p>
<ul>
<li><a class="el" href="sas-qp_ctxt.html#SAS_QP_FRM">SAS_QP_FRM</a>: <em>QP Framework layer</em> </li>
</ul>
</td></tr>
<tr>
<td><p class="starttd"><b>Forward Traceability (truncated to 2 level(s))</b><br  />
</p>
<p class="endtd"></p>
</td></tr>
</table>
<p><a id="a156_SDS_5FQA_5FQMsm_5Ftran" name="a156_SDS_5FQA_5FQMsm_5Ftran"></a> </p>
<h2><a class="anchor" id="SDS_QA_QMsm_tran"></a>
SDS_QA_QMsm_tran</h2>
<table class="doxtable">
<tr>
<td style="text-align:left; width:var(--content-maxwidth)"><p class="starttd"><b>SDS_QA_QMsm_tran</b>: <em>Implementing state transition.</em></p>
<p class="endtd"></p>
</td></tr>
<tr>
<td><p class="starttd"><b>Description</b><br  />
</p>
<p class="endtd">A state transition (see <a class="el" href="#sds-qp_fig-sm">Figure SDS-SM [6]</a>) is coded as special case in the state-handler function. </p>
</td></tr>
<tr>
<td><p class="starttd"><b>Example</b><br  />
</p>
<p class="intertd">The following example code shows a state-handler function with a state transition.  </p><div class="fragment"><div class="line">     <a class="code hl_typedef" href="qp_8h.html#ad141f4e9efcba4613f82a8b2c76663ad">QState</a> ToasterOven_doorClosed(ToasterOven * <span class="keyword">const</span> me, <a class="code hl_class" href="struct_q_evt.html">QEvt</a> <span class="keyword">const</span> * <span class="keyword">const</span> e) {</div>
<div class="line">         <a class="code hl_typedef" href="qp_8h.html#ad141f4e9efcba4613f82a8b2c76663ad">QState</a> status_;</div>
<div class="line">         <span class="keywordflow">switch</span> (e-&gt;<a class="code hl_variable" href="struct_q_evt.html#a20b1ceebb91aea39fcbc633aeae6cd3f">sig</a>) {</div>
<div class="line">             . . .</div>
<div class="line">[1]          <span class="keywordflow">case</span> OPEN_SIG: {</div>
<div class="line">[2]              ToasterOven_actionA(me);</div>
<div class="line">                 <span class="keyword">static</span> <span class="keyword">struct </span>{</div>
<div class="line">                     <a class="code hl_struct" href="struct_q_m_state.html">QMState</a> <span class="keyword">const</span> *target;</div>
<div class="line">                     <a class="code hl_typedef" href="qp_8h.html#ae6ffc980f83c8e9dc039dba0521ae856">QActionHandler</a> act[3];</div>
<div class="line">[3]              } <span class="keyword">const</span> tatbl_ = { <span class="comment">// tran-action table</span></div>
<div class="line">[4]                  &amp;ToasterOven_doorOpen_s, <span class="comment">// target state</span></div>
<div class="line">                     {</div>
<div class="line">[5]                      <a class="code hl_define" href="qp_8h.html#a7e1de8a050ac4678150ab96607c249fd">Q_ACTION_CAST</a>(&amp;ToasterOven_doorClosed_x), <span class="comment">// exit</span></div>
<div class="line">[6]                      <a class="code hl_define" href="qp_8h.html#a7e1de8a050ac4678150ab96607c249fd">Q_ACTION_CAST</a>(&amp;ToasterOven_doorOpen_e), <span class="comment">// entry</span></div>
<div class="line">[7]                      <a class="code hl_define" href="qp_8h.html#aeb993294cc885215f15c5d1238e8d392">Q_ACTION_NULL</a> <span class="comment">// zero terminator</span></div>
<div class="line">                     }</div>
<div class="line">                 };</div>
<div class="line">[8]              status_ = <a class="code hl_define" href="qp_8h.html#af7e90f8b99a650f0550bfb45c5a99cdb">QM_TRAN</a>(&amp;tatbl_);</div>
<div class="line">                 <span class="keywordflow">break</span>;</div>
<div class="line">             }</div>
<div class="line">             . . .</div>
<div class="line">         }</div>
<div class="line">         <span class="keywordflow">return</span> status_;</div>
<div class="line">     }</div>
<div class="ttc" id="aqp_8h_html_af7e90f8b99a650f0550bfb45c5a99cdb"><div class="ttname"><a href="qp_8h.html#af7e90f8b99a650f0550bfb45c5a99cdb">QM_TRAN</a></div><div class="ttdeci">#define QM_TRAN(tatbl_)</div><div class="ttdoc">Macro to call in a QM state-handler when it executes a regular transition. Applicable only to QMsm su...</div><div class="ttdef"><b>Definition</b> <a href="qp_8h_source.html#l00366">qp.h:366</a></div></div>
</div><!-- fragment --><p> <code>[1]</code> State with a transition needs a case-statement on the user-defined signal (transition trigger).</p>
<p class="intertd"><code>[7]</code> Any actions on this initial transition are executed</p>
<p class="intertd"><code>[3-7]</code> The static and const struct called "tran-action table" specifies the sequence of actions to execute:</p><ul>
<li><code>[4]</code> the target state of the initial transition</li>
<li><code>[5]</code> the exit action from the source state</li>
<li><code>[6]</code> the entry action to that target state</li>
<li><code>[7]</code> the "zero terminator" that indicates the end of the "tran-action table"</li>
</ul>
<p class="endtd"><code>[8]</code> The transition must be requested by means of the <a class="el" href="qp_8h.html#af7e90f8b99a650f0550bfb45c5a99cdb" title="Macro to call in a QM state-handler when it executes a regular transition. Applicable only to QMsm su...">QM_TRAN()</a> macro. The argument of this macro is the "tran-action table" specified in steps <code>[3-7]</code>  </p>
</td></tr>
<tr>
<td><p class="starttd"><b>Backward Traceability</b><br  />
</p>
<ul>
<li><a class="el" href="sas-qp_ctxt.html#SAS_QP_FRM">SAS_QP_FRM</a>: <em>QP Framework layer</em> </li>
</ul>
</td></tr>
<tr>
<td><p class="starttd"><b>Forward Traceability (truncated to 2 level(s))</b><br  />
</p>
<p class="endtd"></p>
</td></tr>
</table>
<p><a id="a157_SDS_5FQA_5FQMsm_5Fintern" name="a157_SDS_5FQA_5FQMsm_5Fintern"></a> </p>
<h2><a class="anchor" id="SDS_QA_QMsm_intern"></a>
SDS_QA_QMsm_intern</h2>
<table class="doxtable">
<tr>
<td style="text-align:left; width:var(--content-maxwidth)"><p class="starttd"><b>SDS_QA_QMsm_intern</b>: <em>Implementing internal transition.</em></p>
<p class="endtd"></p>
</td></tr>
<tr>
<td><p class="starttd"><b>Description</b><br  />
</p>
<p class="endtd">An internal transition (see <a class="el" href="#sds-qp_fig-sm">Figure SDS-SM [7]</a>) is coded as special case-statement in the state-handler function. </p>
</td></tr>
<tr>
<td><p class="starttd"><b>Example</b><br  />
</p>
<p class="intertd">The following example code shows a state-handler function with an internal transition.  </p><div class="fragment"><div class="line">     <a class="code hl_typedef" href="qp_8h.html#ad141f4e9efcba4613f82a8b2c76663ad">QState</a> ToasterOven_off(ToasterOven * <span class="keyword">const</span> me, <a class="code hl_class" href="struct_q_evt.html">QEvt</a> <span class="keyword">const</span> * <span class="keyword">const</span> e) {</div>
<div class="line">         <a class="code hl_typedef" href="qp_8h.html#ad141f4e9efcba4613f82a8b2c76663ad">QState</a> status_;</div>
<div class="line">         <span class="keywordflow">switch</span> (e-&gt;<a class="code hl_variable" href="struct_q_evt.html#a20b1ceebb91aea39fcbc633aeae6cd3f">sig</a>) {</div>
<div class="line">             . . .</div>
<div class="line">[1]          <span class="keywordflow">case</span> SETUP_SIG: {</div>
<div class="line">[2]              me-&gt;setup = <a class="code hl_define" href="qp_8h.html#a9f117cb1bc50e9ef4dcc933533ccdd7f">Q_EVT_CAST</a>(SetupEvt)-&gt;setup;</div>
<div class="line">[3]              status_ = <a class="code hl_define" href="qp_8h.html#a7cdc36248f29e47433f8c7a205d6e13d">QM_HANDLED</a>();</div>
<div class="line">                 <span class="keywordflow">break</span>;</div>
<div class="line">             }</div>
<div class="line">             . . .</div>
<div class="line">         }</div>
<div class="line">         <span class="keywordflow">return</span> status_;</div>
<div class="line">     }</div>
<div class="ttc" id="aqp_8h_html_a7cdc36248f29e47433f8c7a205d6e13d"><div class="ttname"><a href="qp_8h.html#a7cdc36248f29e47433f8c7a205d6e13d">QM_HANDLED</a></div><div class="ttdeci">#define QM_HANDLED()</div><div class="ttdoc">Macro to call in a QM state-handler when it handled an event. Applicable only to QMsm subclasses.</div><div class="ttdef"><b>Definition</b> <a href="qp_8h_source.html#l00377">qp.h:377</a></div></div>
</div><!-- fragment --><p> <code>[1]</code> State with a transition needs a case-statement on the user-defined signal (transition trigger).</p>
<p class="intertd"><code>[2]</code> Inside the case, you code all the actions to be called upon the transition.</p>
<p class="endtd"><code>[3]</code> The action list must end with setting the status to the <a class="el" href="qp_8h.html#a7cdc36248f29e47433f8c7a205d6e13d" title="Macro to call in a QM state-handler when it handled an event. Applicable only to QMsm subclasses.">QM_HANDLED()</a> macro, which informs the QP event processor that the <em>internal</em> transition has been handled.  </p>
</td></tr>
<tr>
<td><p class="starttd"><b>Backward Traceability</b><br  />
</p>
<ul>
<li><a class="el" href="sas-qp_ctxt.html#SAS_QP_FRM">SAS_QP_FRM</a>: <em>QP Framework layer</em> </li>
</ul>
</td></tr>
<tr>
<td><p class="starttd"><b>Forward Traceability (truncated to 2 level(s))</b><br  />
</p>
<p class="endtd"></p>
</td></tr>
</table>
<p><a id="a158_SDS_5FQA_5FQMsm_5Fchoice" name="a158_SDS_5FQA_5FQMsm_5Fchoice"></a> </p>
<h2><a class="anchor" id="SDS_QA_QMsm_choice"></a>
SDS_QA_QMsm_choice</h2>
<table class="doxtable">
<tr>
<td style="text-align:left; width:var(--content-maxwidth)"><p class="starttd"><b>SDS_QA_QMsm_choice</b>: <em>Implementing choice point and guard conditions.</em></p>
<p class="endtd"></p>
</td></tr>
<tr>
<td><p class="starttd"><b>Description</b><br  />
</p>
<p class="endtd">A choice point with guard conditions (see <a class="el" href="#sds-qp_fig-sm">Figure SDS-SM [8]</a>) is coded as special case for the user-defined signal (transition trigger). </p>
</td></tr>
<tr>
<td><p class="starttd"><b>Example</b><br  />
</p>
<p class="intertd">The following example code shows a state-handler function with an internal transition.  </p><div class="fragment"><div class="line">    <a class="code hl_typedef" href="qp_8h.html#ad141f4e9efcba4613f82a8b2c76663ad">QState</a> ToasterOven_heating(ToasterOven * <span class="keyword">const</span> me, <a class="code hl_class" href="struct_q_evt.html">QEvt</a> <span class="keyword">const</span> * <span class="keyword">const</span> e) {</div>
<div class="line">        <a class="code hl_typedef" href="qp_8h.html#ad141f4e9efcba4613f82a8b2c76663ad">QState</a> status_;</div>
<div class="line">        <span class="keywordflow">switch</span> (e-&gt;<a class="code hl_variable" href="struct_q_evt.html#a20b1ceebb91aea39fcbc633aeae6cd3f">sig</a>) {</div>
<div class="line">            . . .</div>
<div class="line">[1]         <span class="keywordflow">case</span> TIMEOUT_SIG: {</div>
<div class="line">[2]             me-&gt;temp = BSP_temp();</div>
<div class="line">[3]             <span class="keywordflow">if</span> (me-&gt;temp &gt;= LIMIT) {</div>
<div class="line">[4]                 <span class="comment">// any actions...</span></div>
<div class="line">[5]                   <span class="keyword">static</span> <span class="keyword">struct </span>{</div>
<div class="line">                        <a class="code hl_struct" href="struct_q_m_state.html">QMState</a> <span class="keyword">const</span> *target;</div>
<div class="line">                        <a class="code hl_typedef" href="qp_8h.html#ae6ffc980f83c8e9dc039dba0521ae856">QActionHandler</a> act[3];</div>
<div class="line">                    } <span class="keyword">const</span> tatbl_ = { <span class="comment">// tran-action table</span></div>
<div class="line">                        &amp;ToasterOven_off_s, <span class="comment">// target state</span></div>
<div class="line">                        {</div>
<div class="line">                            <a class="code hl_define" href="qp_8h.html#a7e1de8a050ac4678150ab96607c249fd">Q_ACTION_CAST</a>(&amp;ToasterOven_heating_x), <span class="comment">// exit</span></div>
<div class="line">                            <a class="code hl_define" href="qp_8h.html#a7e1de8a050ac4678150ab96607c249fd">Q_ACTION_CAST</a>(&amp;ToasterOven_off_e), <span class="comment">// entry</span></div>
<div class="line">                            <a class="code hl_define" href="qp_8h.html#aeb993294cc885215f15c5d1238e8d392">Q_ACTION_NULL</a> <span class="comment">// zero terminator</span></div>
<div class="line">                        }</div>
<div class="line">                    };</div>
<div class="line">[6]                 status_ = <a class="code hl_define" href="qp_8h.html#af7e90f8b99a650f0550bfb45c5a99cdb">QM_TRAN</a>(&amp;tatbl_);</div>
<div class="line">                }</div>
<div class="line">[7]             <span class="keywordflow">else</span> {</div>
<div class="line">[8]                 <span class="comment">// any actions...</span></div>
<div class="line">[9]                 status_ = <a class="code hl_define" href="qp_8h.html#a7cdc36248f29e47433f8c7a205d6e13d">QM_HANDLED</a>();</div>
<div class="line">                }</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line">            }</div>
<div class="line">            . . .</div>
<div class="line">        }</div>
<div class="line">        <a class="code hl_define" href="qp_8h.html#a38412fa3c999eeb48624dac1163df663">Q_UNUSED_PAR</a>(me);</div>
<div class="line">        <span class="keywordflow">return</span> status_;</div>
<div class="line">    }</div>
<div class="ttc" id="aqp_8h_html_a38412fa3c999eeb48624dac1163df663"><div class="ttname"><a href="qp_8h.html#a38412fa3c999eeb48624dac1163df663">Q_UNUSED_PAR</a></div><div class="ttdeci">#define Q_UNUSED_PAR(par_)</div><div class="ttdoc">Helper macro to clearly mark unused parameters of functions.</div><div class="ttdef"><b>Definition</b> <a href="qp_8h_source.html#l00097">qp.h:97</a></div></div>
</div><!-- fragment --><p> <code>[1]</code> State-handler needs a case-statement on the user-defined signal (transition trigger).</p>
<p class="intertd"><code>[2]</code> Inside the case, you code all the actions to be called before any guard conditions are evaluated.</p>
<p class="intertd"><code>[3]</code> The guard condition is represented as a condition of the <code>if</code> statement.</p>
<p class="intertd"><code>[4]</code> any actions to be executed if the guard evaluates to 'true'.</p>
<p class="intertd"><code>[5]</code> as usual in all <a class="el" href="struct_q_msm.html" title="Hierarchical State Machine class (QMsm-style state machine implementation strategy)">QMsm</a> transitions, every transition needs a "tran-action table"</p>
<p class="intertd"><code>[6]</code> state transition to a regular state is coded as usual with the <a class="el" href="qp_8h.html#af7e90f8b99a650f0550bfb45c5a99cdb" title="Macro to call in a QM state-handler when it executes a regular transition. Applicable only to QMsm su...">QM_TRAN()</a> macro with the argument being the "tran-action table".</p>
<p class="intertd"><code>[7]</code> the complementary guard condition to all evaluated before is specified with the <code>else</code> statement. </p><dl class="section note"><dt>Note</dt><dd>A choice point might have many outgoing guards, each specified in <code>else if (guard)</code></dd></dl>
<p><code>[8]</code> any actions to be executed for this guard condition.</p>
<p class="endtd"><code>[9]</code> The action list must end with setting the status to the <a class="el" href="qp_8h.html#a7cdc36248f29e47433f8c7a205d6e13d" title="Macro to call in a QM state-handler when it handled an event. Applicable only to QMsm subclasses.">QM_HANDLED()</a> macro, which informs the QP event processor that the <em>internal</em> transition has been handled.  </p>
</td></tr>
<tr>
<td><p class="starttd"><b>Backward Traceability</b><br  />
</p>
<ul>
<li><a class="el" href="sas-qp_ctxt.html#SAS_QP_FRM">SAS_QP_FRM</a>: <em>QP Framework layer</em> </li>
</ul>
</td></tr>
<tr>
<td><p class="starttd"><b>Forward Traceability (truncated to 2 level(s))</b><br  />
</p>
<p class="endtd"></p>
</td></tr>
</table>
<p><a id="a159_SDS_5FQA_5FQMsm_5Fhist" name="a159_SDS_5FQA_5FQMsm_5Fhist"></a> </p>
<h2><a class="anchor" id="SDS_QA_QMsm_hist"></a>
SDS_QA_QMsm_hist</h2>
<table class="doxtable">
<tr>
<td style="text-align:left; width:var(--content-maxwidth)"><p class="starttd"><b>SDS_QA_QMsm_hist</b>: <em>Implementing state history.</em></p>
<p class="endtd"></p>
</td></tr>
<tr>
<td><p class="starttd"><b>Description</b><br  />
</p>
<p class="endtd">State history (see <a class="el" href="#sds-qp_fig-sm">Figure SDS-SM [11]</a>) requires remembering the most recent active substate when the given state is exited, which is accomplished in the exit action from the state coded as already described in <a class="el" href="#SDS_QA_QMsm_exit">SDS_QA_QMsm_exit</a>. </p>
</td></tr>
<tr>
<td><p class="starttd"><b>Example</b><br  />
</p>
<p class="intertd">The following example code shows an exit action that additionally saves the state history.  </p><div class="fragment"><div class="line">[1]  <a class="code hl_typedef" href="qp_8h.html#ad141f4e9efcba4613f82a8b2c76663ad">QState</a> ToasterOven_doorClosed_x(ToasterOven * <span class="keyword">const</span> me) {</div>
<div class="line">[2]      <span class="comment">// any actions...</span></div>
<div class="line">         <span class="comment">// save deep history</span></div>
<div class="line">[3a]     me-&gt;hist_doorClosed = QMsm_stateObj(<a class="code hl_define" href="qp_8h.html#a02785363be76278f9215a0bab212e445">Q_MSM_UPCAST</a>(me));</div>
<div class="line">[3b]     me-&gt;hist_doorClosed = QMsm_childStateObj(<a class="code hl_define" href="qp_8h.html#a02785363be76278f9215a0bab212e445">Q_MSM_UPCAST</a>(me),</div>
<div class="line">                                                  &amp;TstSM_doorClosed_s);</div>
<div class="line">[4]      <span class="keywordflow">return</span> <a class="code hl_define" href="qp_8h.html#af44f060a04828a0d25a99f11dd078f4f">QM_EXIT</a>(&amp;ToasterOven_doorClosed_s);</div>
<div class="line">     }</div>
</div><!-- fragment --><p> <code>[1]</code> The state-exit action function is a member of the state machine class.</p>
<p class="intertd"><code>[2]</code> The state action function calls all the actions to be executed upon the exit from the state.</p>
<p class="intertd"><code>[3]</code> If the state has a history transition, the state-exit action function must set the state history variable. The <a class="el" href="struct_q_msm.html" title="Hierarchical State Machine class (QMsm-style state machine implementation strategy)">QMsm</a> base class provides two member functions to obtain the current state:</p><ul>
<li><a class="el" href="struct_q_msm.html#ab00fb4ad92ffa3078d8ea589424aacfe">QMsm_stateObj</a> to obtain the currently active state for <b>deep history</b></li>
<li><a class="el" href="struct_q_msm.html#ab1fc69e61fc0b02272454d2083742a01">QMsm_childStateObj()</a> to obtain the immediate active child state of the given state for <b>shallow history</b></li>
</ul>
<p class="endtd"><code>[4]</code> The state-exit action function must return the <a class="el" href="qp_8h.html#af44f060a04828a0d25a99f11dd078f4f" title="Macro to call in a QM action-handler when it executes an exit action. Applicable only to QMsm subclas...">QM_EXIT()</a> macro, with the argument being the state struct corresponding to the state being entered.  </p>
</td></tr>
<tr>
<td><p class="starttd"><b>Backward Traceability</b><br  />
</p>
<ul>
<li><a class="el" href="sas-qp_ctxt.html#SAS_QP_FRM">SAS_QP_FRM</a>: <em>QP Framework layer</em> </li>
</ul>
</td></tr>
<tr>
<td><p class="starttd"><b>Forward Traceability (truncated to 2 level(s))</b><br  />
</p>
<p class="endtd"></p>
</td></tr>
</table>
<p><a id="a160_SDS_5FQA_5FQMsm_5Fhist_5Ftran" name="a160_SDS_5FQA_5FQMsm_5Fhist_5Ftran"></a> </p>
<h2><a class="anchor" id="SDS_QA_QMsm_hist_tran"></a>
SDS_QA_QMsm_hist_tran</h2>
<table class="doxtable">
<tr>
<td style="text-align:left; width:var(--content-maxwidth)"><p class="starttd"><b>SDS_QA_QMsm_hist_tran</b>: <em>Implementing transition to history.</em></p>
<p class="endtd"></p>
</td></tr>
<tr>
<td><p class="starttd"><b>Description</b><br  />
</p>
<p class="endtd">Transition to state history (see <a class="el" href="#sds-qp_fig-sm">Figure SDS-SM [12]</a>) is coded similar as a regular state transition, but uses a different macro to take the transition <a class="el" href="qp_8h.html#a14349d32e3cde9c71e97bb6935ea448e" title="Macro to call in a QM state-handler when it executes a transition to history. Applicable only to QMsm...">QM_TRAN_HIST()</a>. </p>
</td></tr>
<tr>
<td><p class="starttd"><b>Example</b><br  />
</p>
<p class="intertd">The following example code shows a transition to state history.  </p><div class="fragment"><div class="line">     <a class="code hl_typedef" href="qp_8h.html#ad141f4e9efcba4613f82a8b2c76663ad">QState</a> ToasterOven_doorOpen(ToasterOven * <span class="keyword">const</span> me, <a class="code hl_class" href="struct_q_evt.html">QEvt</a> <span class="keyword">const</span> * <span class="keyword">const</span> e) {</div>
<div class="line">         <a class="code hl_typedef" href="qp_8h.html#ad141f4e9efcba4613f82a8b2c76663ad">QState</a> status_;</div>
<div class="line">         <span class="keywordflow">switch</span> (e-&gt;<a class="code hl_variable" href="struct_q_evt.html#a20b1ceebb91aea39fcbc633aeae6cd3f">sig</a>) {</div>
<div class="line">             . . .</div>
<div class="line">[1]          <span class="keywordflow">case</span> CLOSE_SIG: {</div>
<div class="line">[2]              <span class="comment">// any actions...</span></div>
<div class="line">                 <span class="keyword">static</span> <span class="keyword">struct </span>{</div>
<div class="line">                     <a class="code hl_struct" href="struct_q_m_state.html">QMState</a> <span class="keyword">const</span> *target;</div>
<div class="line">                     <a class="code hl_typedef" href="qp_8h.html#ae6ffc980f83c8e9dc039dba0521ae856">QActionHandler</a> act[3];</div>
<div class="line">[3]              } <span class="keyword">const</span> tatbl_ = { <span class="comment">// tran-action table</span></div>
<div class="line">                     &amp;ToasterOven_doorClosed_s, <span class="comment">// target state</span></div>
<div class="line">                     {</div>
<div class="line">                         <a class="code hl_define" href="qp_8h.html#a7e1de8a050ac4678150ab96607c249fd">Q_ACTION_CAST</a>(&amp;ToasterOven_doorOpen_x), <span class="comment">// exit</span></div>
<div class="line">                         <a class="code hl_define" href="qp_8h.html#a7e1de8a050ac4678150ab96607c249fd">Q_ACTION_CAST</a>(&amp;ToasterOven_doorClosed_e), <span class="comment">// entry</span></div>
<div class="line">                         <a class="code hl_define" href="qp_8h.html#aeb993294cc885215f15c5d1238e8d392">Q_ACTION_NULL</a> <span class="comment">// zero terminator</span></div>
<div class="line">                     }</div>
<div class="line">                 };</div>
<div class="line">[4]              status_ = <a class="code hl_define" href="qp_8h.html#a14349d32e3cde9c71e97bb6935ea448e">QM_TRAN_HIST</a>(me-&gt;hist_doorClosed, &amp;tatbl_);</div>
<div class="line">                 <span class="keywordflow">break</span>;</div>
<div class="line">             }</div>
<div class="line">             . . .</div>
<div class="line">         }</div>
<div class="line">         <span class="keywordflow">return</span> status_;</div>
<div class="line">     }</div>
<div class="ttc" id="aqp_8h_html_a14349d32e3cde9c71e97bb6935ea448e"><div class="ttname"><a href="qp_8h.html#a14349d32e3cde9c71e97bb6935ea448e">QM_TRAN_HIST</a></div><div class="ttdeci">#define QM_TRAN_HIST(history_, tatbl_)</div><div class="ttdoc">Macro to call in a QM state-handler when it executes a transition to history. Applicable only to QMsm...</div><div class="ttdef"><b>Definition</b> <a href="qp_8h_source.html#l00372">qp.h:372</a></div></div>
</div><!-- fragment --><p> <code>[1]</code> State with a transition to history needs a case-statement for the user-defined signal (transition trigger).</p>
<p class="intertd"><code>[2]</code> Inside the case, you code all the actions to be called upon the transition.</p>
<p class="intertd"><code>[3]</code> The static and const struct called "tran-action table" specifies the sequence of actions to execute.</p>
<p class="endtd"><code>[4]</code> The transition to history must be requested by means of the <a class="el" href="qp_8h.html#a14349d32e3cde9c71e97bb6935ea448e" title="Macro to call in a QM state-handler when it executes a transition to history. Applicable only to QMsm...">QM_TRAN_HIST()</a> macro. The arguments of this macro are the history variable for the given state and the "tran-action table" specified in step <code>[3]</code>  </p>
</td></tr>
<tr>
<td><p class="starttd"><b>Backward Traceability</b><br  />
</p>
<ul>
<li><a class="el" href="sas-qp_ctxt.html#SAS_QP_FRM">SAS_QP_FRM</a>: <em>QP Framework layer</em> </li>
</ul>
</td></tr>
<tr>
<td><p class="starttd"><b>Forward Traceability (truncated to 2 level(s))</b><br  />
</p>
<p class="endtd"></p>
</td></tr>
</table>
<p><span class="prev_button"><a class="el" href="sds-qp_inter.html">Interaction Viewpoint</a></span><span class="next_button"><a class="el" href="sds-qp_time.html">Time Viewpoint</a></span>   </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.9.2-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="sds-qp.html">Software Design Specification</a></li>
    <li class="footer">
<a title="Quantum Leaps: Modern Embedded Software" href="https://www.state-machine.com">&copy; 2005-2025 Quantum Leaps</a> &nbsp;|&nbsp; <a title="help" href="help.html">Using Online Help</a> &nbsp;|&nbsp; <b>QP/C 8.0.2</b> &nbsp;|&nbsp; created with <a title="Spexygen: traceable specifications" href="https://github.com/QuantumLeaps/spexygen"><em>Spexygen</em></a>
<hr class="footer"/><address class="footer"><small>
<a title="Quantum Leaps: Modern Embedded Software" href="https://www.state-machine.com">&copy; 2005-2025 Quantum Leaps</a> &nbsp;|&nbsp; <a title="help" href="help.html">Using Online Help</a> &nbsp;|&nbsp; <b>QP/C 8.0.2</b> &nbsp;|&nbsp; created with <a title="Spexygen: traceable specifications" href="https://github.com/QuantumLeaps/spexygen"><em>Spexygen</em></a>
</small></address>
    </li>
  </ul>
</div>
</body>
</html>
